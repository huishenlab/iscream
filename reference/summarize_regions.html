<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summarize information over genomic regions from any BED file — summarize_regions • iscream</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Summarize information over genomic regions from any BED file — summarize_regions"><meta name="description" content='Run summarizing functions on BED file records across genomic regions.
Parallelized across files using threads from the "iscream.threads" option.'><meta property="og:description" content='Run summarizing functions on BED file records across genomic regions.
Parallelized across files using threads from the "iscream.threads" option.'><meta property="og:image" content="https://huishenlab.github.io/iscream/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iscream</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/iscream.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/performance.html">Improving iscream performance</a></li>
    <li><a class="dropdown-item" href="../articles/data_structures.html">iscream compatible data structures</a></li>
    <li><a class="dropdown-item" href="../articles/TSS.html">Plotting TSS methylation profiles</a></li>
    <li><a class="dropdown-item" href="../articles/tabix.html">iscream vs Rsamtools::scanTabix</a></li>
    <li><a class="dropdown-item" href="../articles/htslib.html">Getting htslib headers</a></li>
    <li><a class="dropdown-item" href="../articles/manuscript_data.html">Manuscript data availabiliy</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/huishenlab/iscream/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Summarize information over genomic regions from any BED file</h1>
      <small class="dont-index">Source: <a href="https://github.com/huishenlab/iscream/blob/main/R/summarize_regions.R" class="external-link"><code>R/summarize_regions.R</code></a></small>
      <div class="d-none name"><code>summarize_regions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run summarizing functions on BED file records across genomic regions.
Parallelized across files using threads from the <code>"iscream.threads"</code> option.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summarize_regions</span><span class="op">(</span></span>
<span>  <span class="va">bedfiles</span>,</span>
<span>  <span class="va">regions</span>,</span>
<span>  <span class="va">columns</span>,</span>
<span>  col_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  feature_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set_region_rownames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bedfiles">bedfiles<a class="anchor" aria-label="anchor" href="#arg-bedfiles"></a></dt>
<dd><p>A vector of BED file paths</p></dd>


<dt id="arg-regions">regions<a class="anchor" aria-label="anchor" href="#arg-regions"></a></dt>
<dd><p>A vector, data frame or GenomicRanges of genomic regions. See
details.</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>A vector of indices of the numeric columns to be summarized</p></dd>


<dt id="arg-col-names">col_names<a class="anchor" aria-label="anchor" href="#arg-col-names"></a></dt>
<dd><p>A vector of names to use for <code>columns</code> in the output</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Function(s) to apply over the region. See details.</p></dd>


<dt id="arg-feature-col">feature_col<a class="anchor" aria-label="anchor" href="#arg-feature-col"></a></dt>
<dd><p>Column name of the input <code>regions</code> data frame containing
a name for each genomic region. Set only if the using a data frame as the
input regions format. See details.</p></dd>


<dt id="arg-set-region-rownames">set_region_rownames<a class="anchor" aria-label="anchor" href="#arg-set-region-rownames"></a></dt>
<dd><p>Use the region strings as the returned data
frame's rownames. Can be useful if you have a named regions and want both
the regions strings rownames and the feature names. See details.</p></dd>


<dt id="arg-nthreads">nthreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>Set number of threads to use overriding the
<code>"iscream.threads"</code> option. See <code><a href="set_threads.html">?set_threads</a></code> for more information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame</p>
    </div>
    <div class="section level2">
    <h2 id="supported-functions">Supported functions<a class="anchor" aria-label="anchor" href="#supported-functions"></a></h2>

<ul><li><p>Sum: <code>"sum"</code></p></li>
<li><p>Mean: <code>"mean"</code></p></li>
<li><p>Median: <code>"median"</code></p></li>
<li><p>Standard deviation: <code>"stddev"</code></p></li>
<li><p>Variance: <code>"variance"</code></p></li>
<li><p>Minimum: <code>"min"</code></p></li>
<li><p>Maximum: <code>"max"</code></p></li>
<li><p>Range: <code>"range"</code></p></li>
<li><p>No. of records in the region: <code>"count"</code></p></li>
</ul><p>The summarizing computations are backed by the Armadillo library. See
<a href="https://arma.sourceforge.net/docs.html#stats_fns" class="external-link">https://arma.sourceforge.net/docs.html#stats_fns</a> for futher details on the
supported functions</p>
    </div>
    <div class="section level2">
    <h2 id="using-feature-identifiers">Using feature identifiers<a class="anchor" aria-label="anchor" href="#using-feature-identifiers"></a></h2>
    <p><code>regions</code> may be string vector in the form "chr:start-end", a GRanges
object or a data frame with "chr", "start", and "end" columns. The <code>feature</code>
column of the output will contain a "chr:start-end" identifier for each
summarized region. To use other identifiers, like a gene name for a region
instead of the coordinates, set the names of the vector or GRanges to those
identifiers. These names will be used instead of the genomic region string
to describe each feature in the output dataframe. If <code>regions</code> is a data
frame make an additional column with the identifiers and pass that column
name to <code>feature_col</code>. See examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">bedfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"iscream"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"[a|b|c|d].bed.gz$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># examine the bedfiles</span></span></span>
<span class="r-in"><span><span class="va">colnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"beta"</span>, <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">bedfiles</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">i</span>, col.names <span class="op">=</span> <span class="va">colnames</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr  | start| end| beta| coverage|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|-----:|---:|----:|--------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     0|   2|  1.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     2|   4|  1.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     4|   6|  0.0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     6|   8|  0.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     8|  10|  0.5|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |    10|  12|  1.0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |    12|  14|  1.0|        3|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr  | start| end| beta| coverage|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|-----:|---:|----:|--------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     0|   2|    0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     4|   6|    1|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     6|   8|    1|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |    10|  12|    0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |    12|  14|    1|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr  | start| end| beta| coverage|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|-----:|---:|----:|--------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     2|   4|    1|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     6|   8|    0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     8|  10|    1|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr  | start| end| beta| coverage|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|-----:|---:|----:|--------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     0|   2|  1.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     2|   4|  1.0|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     6|   8|  0.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |     8|  10|  0.5|        2|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |chr1 |    12|  14|  1.0|        1|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make a vector of regions</span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:1-6"</span>, <span class="st">"chr1:7-10"</span>, <span class="st">"chr1:11-14"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">summarize_regions</span><span class="op">(</span><span class="va">bedfiles</span>, <span class="va">regions</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"cov"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.689220] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.689235] [iscream::summarize_regions] [info] using sum, mean, median, stddev, variance, min, max, range, count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.689238] [iscream::summarize_regions] [info] with columns 4, 5 as beta, cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       feature file beta.sum cov.sum beta.mean cov.mean beta.median cov.median</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    chr1:1-6    a      2.0       4 0.6666667 1.333333        1.00        1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1:7-10    a      0.5       3 0.2500000 1.500000        0.25        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  chr1:11-14    a      2.0       5 1.0000000 2.500000        1.00        2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    chr1:1-6    b      1.0       4 0.5000000 2.000000        0.50        2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1:7-10    b      1.0       1 1.0000000 1.000000        1.00        1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  chr1:11-14    b      1.0       3 0.5000000 1.500000        0.50        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    chr1:1-6    c      1.0       2 1.0000000 2.000000        1.00        2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1:7-10    c      1.0       3 0.5000000 1.500000        0.50        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  chr1:11-14    c       NA      NA        NA       NA          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   chr1:1-6    d      2.0       3 1.0000000 1.500000        1.00        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1:7-10    d      0.5       3 0.2500000 1.500000        0.25        1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 chr1:11-14    d      1.0       1 1.0000000 1.000000        1.00        1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    beta.stddev cov.stddev beta.variance cov.variance beta.min cov.min beta.max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0.5773503  0.5773503     0.3333333    0.3333333        0       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    0.3535534  0.7071068     0.1250000    0.5000000        0       1      0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    0.0000000  0.7071068     0.0000000    0.5000000        1       2      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0.7071068  0.0000000     0.5000000    0.0000000        0       2      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    0.0000000  0.0000000     0.0000000    0.0000000        1       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    0.7071068  0.7071068     0.5000000    0.5000000        0       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    0.0000000  0.0000000     0.0000000    0.0000000        1       2      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    0.7071068  0.7071068     0.5000000    0.5000000        0       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           NA         NA            NA           NA       NA      NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   0.0000000  0.7071068     0.0000000    0.5000000        1       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   0.3535534  0.7071068     0.1250000    0.5000000        0       1      0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   0.0000000  0.0000000     0.0000000    0.0000000        1       1      1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cov.max beta.range cov.range count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        2        1.0         1     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        2        0.5         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        3        0.0         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        2        1.0         0     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        1        0.0         0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        2        1.0         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        2        0.0         0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        2        1.0         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       NA         NA        NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       2        0.0         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       2        0.5         1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       1        0.0         0     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select functions</span></span></span>
<span class="r-in"><span><span class="fu">summarize_regions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">bedfiles</span>,</span></span>
<span class="r-in"><span>  <span class="va">regions</span>,</span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"stddev"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"cov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.702771] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.702783] [iscream::summarize_regions] [info] using mean, stddev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.702786] [iscream::summarize_regions] [info] with columns 4, 5 as beta, cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       feature file beta.mean cov.mean beta.stddev cov.stddev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    chr1:1-6    a 0.6666667 1.333333   0.5773503  0.5773503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1:7-10    a 0.2500000 1.500000   0.3535534  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  chr1:11-14    a 1.0000000 2.500000   0.0000000  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    chr1:1-6    b 0.5000000 2.000000   0.7071068  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1:7-10    b 1.0000000 1.000000   0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  chr1:11-14    b 0.5000000 1.500000   0.7071068  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    chr1:1-6    c 1.0000000 2.000000   0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1:7-10    c 0.5000000 1.500000   0.7071068  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  chr1:11-14    c        NA       NA          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   chr1:1-6    d 1.0000000 1.500000   0.0000000  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1:7-10    d 0.2500000 1.500000   0.3535534  0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 chr1:11-14    d 1.0000000 1.000000   0.0000000  0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add names to the regions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">summarize_regions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">bedfiles</span>,</span></span>
<span class="r-in"><span>  <span class="va">regions</span>,</span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="st">"sum"</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  col_names <span class="op">=</span> <span class="st">"coverage"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.706626] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.706638] [iscream::summarize_regions] [info] using sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.706641] [iscream::summarize_regions] [info] with columns 5 as coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature file coverage.sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        A    a            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        B    a            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        C    a            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        A    b            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        B    b            1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        C    b            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        A    c            2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        B    c            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        C    c           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       A    d            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       B    d            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       C    d            1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using `feature_col`</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert string vector to a data.table</span></span></span>
<span class="r-in"><span><span class="va">regions_df</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="va">_</span><span class="op">[</span>, <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/tstrsplit.html" class="external-link">tstrsplit</a></span><span class="op">(</span><span class="va">regions</span>, <span class="st">":|-"</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="st">"start"</span>, <span class="st">"end"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="va">_</span><span class="op">[</span>, <span class="va">start</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">start</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="va">_</span><span class="op">[</span>, <span class="va">feature</span> <span class="op">:=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="va">.I</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">regions_df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       chr start    end feature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;char&gt; &lt;int&gt; &lt;char&gt;  &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   chr1     1      6       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:   chr1     7     10       B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:   chr1    11     14       C</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">summarize_regions</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">bedfiles</span>,</span></span>
<span class="r-in"><span>  <span class="va">regions_df</span>,</span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="st">"sum"</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  col_names <span class="op">=</span> <span class="st">"coverage"</span>,</span></span>
<span class="r-in"><span>  feature_col <span class="op">=</span> <span class="st">"feature"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.720649] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.720664] [iscream::summarize_regions] [info] using sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15:18:03.720667] [iscream::summarize_regions] [info] with columns 5 as coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature file coverage.sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        A    a            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        B    a            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        C    a            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        A    b            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        B    b            1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        C    b            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        A    c            2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        B    c            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        C    c           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       A    d            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       B    d            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       C    d            1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Eapen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

