[{"path":"https://huishenlab.github.io/iscream/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 iscream authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Plotting TSS methylation profiles","text":"","code":"options(\"iscream.threads\" = 8) library(iscream) library(data.table) library(ggplot2)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"download-the-data","dir":"Articles","previous_headings":"Setup","what":"Download the data","title":"Plotting TSS methylation profiles","text":"Running vignette requires downloading 18MB BED files tabix indices Zenodo record: https://zenodo.org/records/14733834 First, generate list BED file paths:","code":"methscan_zip_path <- tempfile(\"methscan\") methscan_dir <- tempdir() download.file(     \"https://zenodo.org/records/14733834/files/methscan_data.zip\",     destfile = methscan_zip_path ) unzip(methscan_zip_path, exdir = methscan_dir) start_time = proc.time() data_dir <- paste0(methscan_dir, \"/scbs_tutorial_data\") bedfiles <- list.files(     data_dir,     pattern = \"*.cov.gz$\",     full.names = TRUE )"},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"get-the-transcription-start-sites-and-flanking-regions","dir":"Articles","previous_headings":"Using tabix()","what":"Get the Transcription start sites and flanking regions","title":"Plotting TSS methylation profiles","text":"read provided TSS BED file create 2kb flanking regions around start sites.","code":"tss.regions <- fread(     paste0(data_dir, \"/Mus_musculus.GRCm38.102_TSS.bed\"), drop = c(3, 5, 6) ) colnames(tss.regions) <- c(\"chr\", \"tss\", \"geneID\") head(tss.regions) ##       chr     tss             geneID ##    <char>   <int>             <char> ## 1:      1 3671498 ENSMUSG00000051951 ## 2:      1 4409241 ENSMUSG00000025900 ## 3:      1 4496413 ENSMUSG00000025902 ## 4:      1 4785739 ENSMUSG00000033845 ## 5:      1 4807823 ENSMUSG00000025903 ## 6:      1 4857814 ENSMUSG00000033813 tss.regions[, `:=`(tss.start = tss - 2000, tss.end = tss + 2000)]  # make a new data frame with chr, start, end as iscream requires these columns tss.for_query <- tss.regions[, .(chr, start = tss.start, end = tss.end)]"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"make-a-tabix-query-of-the-tss-flanking-regions","dir":"Articles","previous_headings":"Using tabix()","what":"Make a tabix query of the TSS flanking regions","title":"Plotting TSS methylation profiles","text":"tabix() function queries provided BED files TSS flanking regions produce data frame:","code":"query_runtime.start <- proc.time() tss.query <- tabix(bedfiles, tss.for_query, aligner = \"bismark\") head(tss.query) ##       chr   start     end methylation.percentage count.methylated ##    <char>   <int>   <int>                  <num>            <int> ## 1:      1 4785488 4785488                      0                0 ## 2:      1 4785513 4785513                      0                0 ## 3:      1 4785522 4785522                      0                0 ## 4:      1 4785533 4785533                      0                0 ## 5:      1 4786780 4786780                    100                1 ## 6:      1 4786886 4786886                    100                1 ##    count.unmethylated    file ##                 <int>  <char> ## 1:                  2 cell_01 ## 2:                  2 cell_01 ## 3:                  2 cell_01 ## 4:                  2 cell_01 ## 5:                  0 cell_01 ## 6:                  0 cell_01"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"summarize-average-methylation-profile-around-tss","dir":"Articles","previous_headings":"Using tabix()","what":"Summarize average methylation profile around TSS","title":"Plotting TSS methylation profiles","text":"Given CpG level methylation data frame, now join queried data based CpGs fall within TSS flanking regions get CpGs 2kb around TSS. can also set new position column relative TSS (using rounded values methscan tutorial): Time make query compute summary: 2.444s elapsed (5.262s cpu).","code":"# join tss.profile <- tss.regions[tss.query, .(     chr,     start,     position = round(start - tss, -1L),     methylation.percentage,     file   ),   on = .(chr, tss.start <= start, tss.end >= end) ] |> unique()  # get mean methylation by relative position and cell tss.summary <- tss.profile[,   .(meth_frac = mean(methylation.percentage/100)),   by = .(position, file) ]  query_runtime <- timetaken(query_runtime.start)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"plot-average-methylation-profiles-around-the-tss","dir":"Articles","previous_headings":"Using tabix()","what":"Plot average methylation profiles around the TSS","title":"Plotting TSS methylation profiles","text":"TSS profiles Total runtime, getting BED files regions making query, calculating summaries plotting: 2.489s elapsed (5.307s cpu). methscan, generating TSS methylation profiles alone took 11 seconds.","code":"tss.plot <- ggplot(tss.summary, aes(x = position / 1000, y = meth_frac)) +   scale_y_continuous(     labels=scales::percent_format(accuracy=1),     limits=c(0, 1), breaks=c(0, .5, 1)   ) +   geom_line(linewidth = .1) +   facet_wrap(~file) +   labs(x = \"position relative to TSS [kb]\", y = \"DNA methylation\")  total_runtime <- timetaken(start_time)  tss.plot"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"using-summarize_regions","dir":"Articles","previous_headings":"","what":"Using summarize_regions","title":"Plotting TSS methylation profiles","text":"similar analysis can done using summarize_regions() function need see distribution beta means file, rather means relative position per file TSS distribution file per-file means collapse means within file: Mean TSS file","code":"library(\"ggridges\") tss.means <- summarize_meth_regions(   bedfiles,   tss.for_query,   aligner = \"bismark\",   fun = \"mean\",   mval = FALSE ) |> as.data.table() ## [11:28:24.770899] [iscream::summarize_regions] [info] Summarizing 21622 regions from 30 bedfiles ## [11:28:24.770922] [iscream::summarize_regions] [info] using mean ## [11:28:24.770925] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, beta ggplot(tss.means, aes(x = beta.mean, y = file, fill = after_stat(x))) +   geom_density_ridges_gradient() +   scale_fill_distiller(palette = \"BrBG\") +   theme_classic() tss.means[, .(beta.mean = mean(beta.mean, na.rm = TRUE)), by = file] |>   ggplot(     aes(       x = reorder(file, beta.mean),       y = beta.mean,       fill = beta.mean)     ) +   geom_bar(stat = 'identity') +   scale_fill_viridis_c() +   theme_classic() +   coord_flip() +   labs(x = \"Sample\")"},{"path":"https://huishenlab.github.io/iscream/dev/articles/TSS.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Plotting TSS methylation profiles","text":"","code":"sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.2 LTS ##  ## Matrix products: default ## BLAS/LAPACK: /nix/store/yf6dpab0gcjr9gvpww1zlafs9n0f48h3-blas-3/lib/libblas.so.3;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: America/Detroit ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggridges_0.5.6    ggplot2_3.5.2     data.table_1.17.8 iscream_0.99.0    ##  ## loaded via a namespace (and not attached): ##  [1] vctrs_0.6.5         cli_3.6.3           knitr_1.47          ##  [4] rlang_1.1.4         xfun_0.52           highr_0.11          ##  [7] generics_0.1.4      labeling_0.4.3      RcppParallel_5.1.10 ## [10] glue_1.7.0          stringfish_0.16.0   scales_1.4.0        ## [13] grid_4.5.1          evaluate_0.24.0     tibble_3.3.0        ## [16] lifecycle_1.0.4     compiler_4.5.1      dplyr_1.1.4         ## [19] RColorBrewer_1.1-3  Rcpp_1.1.0          pkgconfig_2.0.3     ## [22] farver_2.1.2        lattice_0.22-7      viridisLite_0.4.2   ## [25] R6_2.5.1            tidyselect_1.2.1    pillar_1.11.0       ## [28] parallelly_1.45.0   parallel_4.5.1      magrittr_2.0.3      ## [31] Matrix_1.7-3        withr_3.0.0         tools_4.5.1         ## [34] gtable_0.3.5"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"genomicranges","dir":"Articles","previous_headings":"","what":"GenomicRanges","title":"iscream compatible data structures","text":"GRanges objects can used input regions iscream’s functions can returned tabix_gr() make_mat_gr().","code":"library(GenomicRanges)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"from-tabix-queries","dir":"Articles","previous_headings":"GenomicRanges","what":"From tabix queries","title":"iscream compatible data structures","text":"tabix_gr() returns GenomicRanges object. regions parameter can string vector, data frame GRanges object. given GRanges object metadata, columns preserved output. data.table output tabix() can also piped GRanges, preserve input metadata. input BED file zero-based (e.g. Bismark coverage files), set zero_based = FALSE tabix() call get correct conversion data frame GenomicRanges.","code":"gr <- GRanges(regions) values(gr) <- DataFrame(     gene = c(\"gene1\", \"gene2\", \"gene3\"),     some_metadata = c(\"s1\", \"s2\", \"s3\") ) gr ## GRanges object with 3 ranges and 2 metadata columns: ##     seqnames    ranges strand |        gene some_metadata ##        <Rle> <IRanges>  <Rle> | <character>   <character> ##   A     chr1       1-6      * |       gene1            s1 ##   B     chr1      7-10      * |       gene2            s2 ##   C     chr1     11-14      * |       gene3            s3 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths tabix_gr(bedfiles[1], gr) ## GRanges object with 7 ranges and 4 metadata columns: ##       seqnames    ranges strand |        V1        V2        gene some_metadata ##          <Rle> <IRanges>  <Rle> | <numeric> <integer> <character>   <character> ##   [1]     chr1       1-2      * |       1.0         1       gene1            s1 ##   [2]     chr1       3-4      * |       1.0         1       gene1            s1 ##   [3]     chr1       5-6      * |       0.0         2       gene1            s1 ##   [4]     chr1       7-8      * |       0.0         1       gene2            s2 ##   [5]     chr1      9-10      * |       0.5         2       gene2            s2 ##   [6]     chr1     11-12      * |       1.0         2       gene3            s3 ##   [7]     chr1     13-14      * |       1.0         3       gene3            s3 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths tabix(bedfiles[1], gr) |>   makeGRangesFromDataFrame(     starts.in.df.are.0based = TRUE,     keep.extra.columns = TRUE   ) ## GRanges object with 7 ranges and 2 metadata columns: ##       seqnames    ranges strand |        V1        V2 ##          <Rle> <IRanges>  <Rle> | <numeric> <integer> ##   [1]     chr1       1-2      * |       1.0         1 ##   [2]     chr1       3-4      * |       1.0         1 ##   [3]     chr1       5-6      * |       0.0         2 ##   [4]     chr1       7-8      * |       0.0         1 ##   [5]     chr1      9-10      * |       0.5         2 ##   [6]     chr1     11-12      * |       1.0         2 ##   [7]     chr1     13-14      * |       1.0         3 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"from-summarize_regions","dir":"Articles","previous_headings":"GenomicRanges","what":"From summarize_regions()","title":"iscream compatible data structures","text":"summarize_regions() returns data frame feature column identifying summary row’s genomic region. region features named (see ?summarize_regions), pass feature column genomic regions GRanges input regions. , since regions vector named, using unname cause feature column populate regions strings: input regions named use set_region_rownames = TRUE genomic regions strings preserved use GRanges input regions.","code":"(summary <- summarize_meth_regions(   bedfiles,   unname(regions),   fun = c(\"sum\", \"mean\")) ) ## [18:21:13.547777] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles ## [18:21:13.547807] [iscream::summarize_regions] [info] using sum, mean ## [18:21:13.547812] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, M ##       feature file coverage.sum M.sum coverage.mean    M.mean ## 1    chr1:1-6    a            4     2      1.333333 0.6666667 ## 2   chr1:7-10    a            3     1      1.500000 0.5000000 ## 3  chr1:11-14    a            5     5      2.500000 2.5000000 ## 4    chr1:1-6    b            4     2      2.000000 1.0000000 ## 5   chr1:7-10    b            1     1      1.000000 1.0000000 ## 6  chr1:11-14    b            3     1      1.500000 0.5000000 ## 7    chr1:1-6    c            2     2      2.000000 2.0000000 ## 8   chr1:7-10    c            3     1      1.500000 0.5000000 ## 9  chr1:11-14    c           NA    NA            NA        NA ## 10   chr1:1-6    d            3     3      1.500000 1.5000000 ## 11  chr1:7-10    d            3     1      1.500000 0.5000000 ## 12 chr1:11-14    d            1     1      1.000000 1.0000000 GRanges(summary$feature, summary = summary[, -1]) ## GRanges object with 12 ranges and 5 metadata columns: ##        seqnames    ranges strand | summary.file summary.coverage.sum ##           <Rle> <IRanges>  <Rle> |  <character>            <numeric> ##    [1]     chr1       1-6      * |            a                    4 ##    [2]     chr1      7-10      * |            a                    3 ##    [3]     chr1     11-14      * |            a                    5 ##    [4]     chr1       1-6      * |            b                    4 ##    [5]     chr1      7-10      * |            b                    1 ##    ...      ...       ...    ... .          ...                  ... ##    [8]     chr1      7-10      * |            c                    3 ##    [9]     chr1     11-14      * |            c                   NA ##   [10]     chr1       1-6      * |            d                    3 ##   [11]     chr1      7-10      * |            d                    3 ##   [12]     chr1     11-14      * |            d                    1 ##        summary.M.sum summary.coverage.mean summary.M.mean ##            <numeric>             <numeric>      <numeric> ##    [1]             2               1.33333       0.666667 ##    [2]             1               1.50000       0.500000 ##    [3]             5               2.50000       2.500000 ##    [4]             2               2.00000       1.000000 ##    [5]             1               1.00000       1.000000 ##    ...           ...                   ...            ... ##    [8]             1                   1.5            0.5 ##    [9]            NA                    NA             NA ##   [10]             3                   1.5            1.5 ##   [11]             1                   1.5            0.5 ##   [12]             1                   1.0            1.0 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths (summary <- summarize_regions(   bedfiles,   regions,   column = 4,   set_region_rownames = TRUE,   fun = c(\"sum\", \"mean\")) ) ## [18:21:13.664416] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles ## [18:21:13.664439] [iscream::summarize_regions] [info] using sum, mean ## [18:21:13.664443] [iscream::summarize_regions] [info] with columns 4 as V1 ##            feature file V1.sum   V1.mean ## chr1:1-6         A    a    2.0 0.6666667 ## chr1:7-10        B    a    0.5 0.2500000 ## chr1:11-14       C    a    2.0 1.0000000 ## chr1:1-6         A    b    1.0 0.5000000 ## chr1:7-10        B    b    1.0 1.0000000 ## chr1:11-14       C    b    1.0 0.5000000 ## chr1:1-6         A    c    1.0 1.0000000 ## chr1:7-10        B    c    1.0 0.5000000 ## chr1:11-14       C    c     NA        NA ## chr1:1-6         A    d    2.0 1.0000000 ## chr1:7-10        B    d    0.5 0.2500000 ## chr1:11-14       C    d    1.0 1.0000000 GRanges(rownames(summary), summary = summary) ## GRanges object with 12 ranges and 4 metadata columns: ##        seqnames    ranges strand | summary.feature summary.file summary.V1.sum ##           <Rle> <IRanges>  <Rle> |     <character>  <character>      <numeric> ##    [1]     chr1       1-6      * |               A            a            2.0 ##    [2]     chr1      7-10      * |               B            a            0.5 ##    [3]     chr1     11-14      * |               C            a            2.0 ##    [4]     chr1       1-6      * |               A            b            1.0 ##    [5]     chr1      7-10      * |               B            b            1.0 ##    ...      ...       ...    ... .             ...          ...            ... ##    [8]     chr1      7-10      * |               B            c            1.0 ##    [9]     chr1     11-14      * |               C            c             NA ##   [10]     chr1       1-6      * |               A            d            2.0 ##   [11]     chr1      7-10      * |               B            d            0.5 ##   [12]     chr1     11-14      * |               C            d            1.0 ##        summary.V1.mean ##              <numeric> ##    [1]        0.666667 ##    [2]        0.250000 ##    [3]        1.000000 ##    [4]        0.500000 ##    [5]        1.000000 ##    ...             ... ##    [8]            0.50 ##    [9]              NA ##   [10]            1.00 ##   [11]            0.25 ##   [12]            1.00 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"from-make_mat","dir":"Articles","previous_headings":"GenomicRanges","what":"From make_mat","title":"iscream compatible data structures","text":"make_mat_gr() returns GRanges object dense matrices.","code":"make_mat_gr(bedfiles, regions, column = 4, mat_name = \"beta\") ## [18:21:13.779975] [iscream::query_all] [info] Querying 3 regions from 4 bedfiles ##  ## [18:21:13.780344] [iscream::query_all] [info] Creating metadata vectors ## [18:21:13.780386] [iscream::query_all] [info] 7 loci found - 9993 extra rows allocated with 0 resizes ## [18:21:13.780389] [iscream::query_all] [info] Creating dense matrix ## GRanges object with 7 ranges and 4 metadata columns: ##       seqnames    ranges strand |         a         b         c         d ##          <Rle> <IRanges>  <Rle> | <numeric> <numeric> <numeric> <numeric> ##   [1]     chr1         0      * |       1.0         0         0       1.0 ##   [2]     chr1         2      * |       1.0         0         1       1.0 ##   [3]     chr1         4      * |       0.0         1         0       0.0 ##   [4]     chr1         6      * |       0.0         1         0       0.0 ##   [5]     chr1         8      * |       0.5         0         1       0.5 ##   [6]     chr1        10      * |       1.0         0         0       0.0 ##   [7]     chr1        12      * |       1.0         1         0       1.0 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"summarizedexperiment","dir":"Articles","previous_headings":"","what":"SummarizedExperiment","title":"iscream compatible data structures","text":"make_mat_se() returns RangedSummarizedExperiment sparse dense matrices.","code":"make_mat_se(bedfiles, regions, column = 4, mat_name = \"beta\", sparse = TRUE) ## [18:21:15.980507] [iscream::query_all] [info] Querying 3 regions from 4 bedfiles ##  ## [18:21:15.980892] [iscream::query_all] [info] Creating metadata vectors ## [18:21:15.980915] [iscream::query_all] [info] 7 loci found - 9993 extra rows allocated with 0 resizes ## [18:21:15.980922] [iscream::query_all] [info] Creating sparse matrix ## class: RangedSummarizedExperiment  ## dim: 7 4  ## metadata(0): ## assays(1): beta ## rownames: NULL ## rowData names(0): ## colnames(4): a b c d ## colData names(0):"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"making-bsseq-objects","dir":"Articles","previous_headings":"SummarizedExperiment","what":"Making BSseq objects","title":"iscream compatible data structures","text":"bsseq object type SummarizedExperiment, handle sparse matrices:","code":"library(bsseq) do.call(BSseq, mats)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/data_structures.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"iscream compatible data structures","text":"","code":"sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ## [1] GenomicRanges_1.60.0 GenomeInfoDb_1.44.1  IRanges_2.42.0       ## [4] S4Vectors_0.46.0     BiocGenerics_0.54.0  generics_0.1.4       ## [7] iscream_0.99.0       BiocStyle_2.36.0     ##  ## loaded via a namespace (and not attached): ##  [1] sass_0.4.10                 SparseArray_1.8.1           ##  [3] lattice_0.22-7              digest_0.6.37               ##  [5] evaluate_1.0.4              grid_4.5.1                  ##  [7] bookdown_0.43               fastmap_1.2.0               ##  [9] jsonlite_2.0.0              Matrix_1.7-3                ## [11] BiocManager_1.30.26         httr_1.4.7                  ## [13] UCSC.utils_1.4.0            textshaping_1.0.1           ## [15] jquerylib_0.1.4             abind_1.4-8                 ## [17] cli_3.6.5                   rlang_1.1.6                 ## [19] crayon_1.5.3                XVector_0.48.0              ## [21] Biobase_2.68.0              parallelly_1.45.1           ## [23] DelayedArray_0.34.1         cachem_1.1.0                ## [25] yaml_2.3.10                 S4Arrays_1.8.1              ## [27] tools_4.5.1                 parallel_4.5.1              ## [29] GenomeInfoDbData_1.2.14     SummarizedExperiment_1.38.1 ## [31] R6_2.6.1                    matrixStats_1.5.0           ## [33] lifecycle_1.0.4             fs_1.6.6                    ## [35] stringfish_0.17.0           ragg_1.4.0                  ## [37] desc_1.4.3                  pkgdown_2.1.3               ## [39] RcppParallel_5.1.10         bslib_0.9.0                 ## [41] data.table_1.17.8           Rcpp_1.1.0                  ## [43] systemfonts_1.2.3           xfun_0.52                   ## [45] MatrixGenerics_1.20.0       knitr_1.50                  ## [47] htmltools_0.5.8.1           rmarkdown_2.29              ## [49] compiler_4.5.1"},{"path":"https://huishenlab.github.io/iscream/dev/articles/htslib.html","id":"condaminicondamambamicromamba","dir":"Articles","previous_headings":"","what":"Conda/miniconda/mamba/micromamba","title":"Getting htslib headers","text":"Create environment.yaml following contents install htslib 1.21: Add file project directory run Confirm headers available compilation get something like","code":"name: iscream channels:   - bioconda   - conda-forge dependencies:   - htslib=1.21   - pkg-config=0.29.2 conda env create -f environment.yaml conda activate iscream export PKG_CONFIG_PATH=$CONDA_PREFIX/lib export LD_LIBRARY_PATH=$CONDA_PREFIX/lib/ pkg-config --cflags --libs htslib -I/home/user/miniconda3/envs/iscream/include -L/home/user/miniconda3/envs/iscream/lib -lhts"},{"path":"https://huishenlab.github.io/iscream/dev/articles/htslib.html","id":"pixi","dir":"Articles","previous_headings":"","what":"Pixi","title":"Getting htslib headers","text":"Pixi uses conda repositories install packages. Create pixi.toml file content add file project directory: create environment required system dependencies run Confirm headers available compilation get something like","code":"[project] channels = [\"conda-forge\", \"bioconda\"] name = \"iscream\" platforms = [\"linux-64\"] version = \"0.1.0\"  [activation.env] LD_LIBRARY_PATH=\"$CONDA_PREFIX/lib\"  [dependencies] htslib = \"1.21.*\" pkg-config = \">=0.29.2,<0.30\" pixi shell pkg-config --cflags --libs htslib -I/home/user/iscream/.pixi/envs/default/include -L/home/user/iscream/.pixi/envs/default/lib -lhts"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"An introduction to iscream","text":"iscream BED file querying package can can retrieve records within regions interest multiple tabixed BED files. can make queries like tabix, summarize data within regions make matrices across input files regions. operations can done parallel return R/Bioconductor data structures. iscream may installed https://bioconductor.org iscream designed memory efficient fast large datasets. vignette demonstrates iscream’s functions small dataset. information performance considerations large datasets see vignette(\"performance\").","code":"if (!require(\"BiocManager\"))     install.packages(\"BiocManager\") BiocManager::install(\"iscream\")"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"loading-iscream","dir":"Articles","previous_headings":"Introduction","what":"Loading iscream","title":"An introduction to iscream","text":"load, iscream inform user number threads set use. configurable either set_threads() setting option(\"iscream.threads\"), can done .Rprofile set startup. loaded use following querying functions.","code":"library(iscream) ## iscream using 1 thread by default but parallelly::availableCores() detects 4 possibly available threads. See `?set_threads` for information on multithreading before trying to use more. set_threads(2) ## iscream now using 2 of 4 available threads."},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"tabix","dir":"Articles","previous_headings":"","what":"tabix()","title":"An introduction to iscream","text":"tabix command-line tool queries records compressed BED files. input receives path tabixed BED file one genomic regions interest. queries prints records tabixed BED file fall within regions interest. output may redirected file read R. iscream’s tabix() function works similar way supports multiple files multiple input formats one function. receives vector paths tabixed BED files regions interest. input regions may vector \"chr:start-end\" strings, data frame \"chr\", \"start\", \"end\" columns GRanges object. queries BED files returns records parsed data.table. get GRanges object instead, use tabix_gr. Using iscream eliminates context switching shell R tabix queries since queries made R result R data structure. Rsamtools another R package can query data BED files, supports one file time, accepts GRanges input regions parse tab-delimited strings. See vignette(\"tabix\") comparison iscream Rsamtools.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"setup","dir":"Articles","previous_headings":"tabix()","what":"Setup","title":"An introduction to iscream","text":"Using list.files(), can get paths compressed bed files directory. files contain small regions chromosome 1 Y snmC-seq2 methylation data (Luo et al. 2018). demonstration, ’m using two regions. Note: dataset chromosome identifier “chr[number]” format. However, datasets, chromosome ID just number letter like ‘1’, ‘Y’. see chromosome ID format across files can use query_chroms() get unique chromosomes across input files:","code":"data_dir <- system.file(\"extdata\", package = \"iscream\") (bedfiles <- list.files(   data_dir,   pattern = \"cell[1-5].bed.gz$\",   full.names = TRUE)) ## [1] \"/home/runner/work/_temp/Library/iscream/extdata/cell1.bed.gz\" ## [2] \"/home/runner/work/_temp/Library/iscream/extdata/cell2.bed.gz\" ## [3] \"/home/runner/work/_temp/Library/iscream/extdata/cell3.bed.gz\" ## [4] \"/home/runner/work/_temp/Library/iscream/extdata/cell4.bed.gz\" regions <- c(\"chr1:184577-680065\", \"chrY:56877780-56882524\") query_chroms(bedfiles) ## [1] \"chr1\" \"chrY\""},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"making-queries","dir":"Articles","previous_headings":"tabix()","what":"Making queries","title":"An introduction to iscream","text":"tabix() one file: multiple files, output contains column file name.","code":"tabix(bedfiles[1], regions) ##        chr    start      end    V1    V2 ##     <char>    <int>    <int> <num> <int> ##  1:   chr1   184577   184578     0     1 ##  2:   chr1   191223   191224     0     1 ##  3:   chr1   191264   191265     0     1 ##  4:   chr1   191307   191308     0     1 ##  5:   chr1   191491   191492     0     1 ##  6:   chr1   191507   191508     0     1 ##  7:   chr1   191526   191527     0     1 ##  8:   chr1   679950   679951     1     1 ##  9:   chr1   680064   680065     1     1 ## 10:   chrY 56877780 56877781     0     1 ## 11:   chrY 56878350 56878351     0     1 ## 12:   chrY 56878351 56878352     0     1 ## 13:   chrY 56878431 56878432     0     1 ## 14:   chrY 56879483 56879484     0     2 ## 15:   chrY 56879535 56879536     0     2 ## 16:   chrY 56879539 56879540     1     1 ## 17:   chrY 56879724 56879725     0     1 ## 18:   chrY 56879834 56879835     0     1 ## 19:   chrY 56879863 56879864     1     1 ## 20:   chrY 56879915 56879916     1     1 ## 21:   chrY 56879945 56879946     1     1 ## 22:   chrY 56881130 56881131     1     1 ## 23:   chrY 56881926 56881927     1     1 ## 24:   chrY 56882523 56882524     0     1 ##        chr    start      end    V1    V2 tabix(bedfiles, regions) ##        chr    start      end    V1    V2   file ##     <char>    <int>    <int> <num> <int> <char> ##  1:   chr1   184577   184578     0     1  cell1 ##  2:   chr1   191223   191224     0     1  cell1 ##  3:   chr1   191264   191265     0     1  cell1 ##  4:   chr1   191307   191308     0     1  cell1 ##  5:   chr1   191491   191492     0     1  cell1 ## ---                                             ## 70:   chrY 56880518 56880519     0     1  cell4 ## 71:   chrY 56880715 56880716     0     2  cell4 ## 72:   chrY 56880914 56880915     0     2  cell4 ## 73:   chrY 56881927 56881928     1     1  cell4 ## 74:   chrY 56882345 56882346     1     1  cell4"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"using-genomicranges","dir":"Articles","previous_headings":"tabix()","what":"Using GenomicRanges","title":"An introduction to iscream","text":"tabix() tabix_gr() accept GRanges objects input regions tabix_gr() returns GRanges objects instead data frames. tabix_gr also preserve input GRanges metadata.","code":"library(GenomicRanges) gr <- GRanges(regions) tabix_gr(bedfiles, gr) ## GRangesList object of length 4: ## $cell1 ## GRanges object with 24 ranges and 3 metadata columns: ##        seqnames    ranges strand |        V1        V2        file ##           <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> ##    [1]     chr1    184578      * |         0         1       cell1 ##    [2]     chr1    191224      * |         0         1       cell1 ##    [3]     chr1    191265      * |         0         1       cell1 ##    [4]     chr1    191308      * |         0         1       cell1 ##    [5]     chr1    191492      * |         0         1       cell1 ##    ...      ...       ...    ... .       ...       ...         ... ##   [20]     chrY  56879916      * |         1         1       cell1 ##   [21]     chrY  56879946      * |         1         1       cell1 ##   [22]     chrY  56881131      * |         1         1       cell1 ##   [23]     chrY  56881927      * |         1         1       cell1 ##   [24]     chrY  56882524      * |         0         1       cell1 ##   ------- ##   seqinfo: 2 sequences from an unspecified genome; no seqlengths ##  ## ... ## <3 more elements>"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"setting-column-names","dir":"Articles","previous_headings":"tabix()","what":"Setting column names","title":"An introduction to iscream","text":"can set result data frame’s column names GRanges mcols col.names:","code":"tabix_gr(bedfiles, regions, col.names = c(\"beta\", \"coverage\")) ## GRangesList object of length 4: ## $cell1 ## GRanges object with 24 ranges and 3 metadata columns: ##        seqnames    ranges strand |      beta  coverage        file ##           <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> ##    [1]     chr1    184578      * |         0         1       cell1 ##    [2]     chr1    191224      * |         0         1       cell1 ##    [3]     chr1    191265      * |         0         1       cell1 ##    [4]     chr1    191308      * |         0         1       cell1 ##    [5]     chr1    191492      * |         0         1       cell1 ##    ...      ...       ...    ... .       ...       ...         ... ##   [20]     chrY  56879916      * |         1         1       cell1 ##   [21]     chrY  56879946      * |         1         1       cell1 ##   [22]     chrY  56881131      * |         1         1       cell1 ##   [23]     chrY  56881927      * |         1         1       cell1 ##   [24]     chrY  56882524      * |         0         1       cell1 ##   ------- ##   seqinfo: 2 sequences from an unspecified genome; no seqlengths ##  ## ... ## <3 more elements>"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"rsamtools-style-output","dir":"Articles","previous_headings":"tabix()","what":"Rsamtools-style output","title":"An introduction to iscream","text":"tabix_raw() return unparsed named list like Rsamtools, multi-file support:","code":"tabix_raw(bedfiles, regions) ## $cell1 ## $cell1$`chr1:184577-680065` ## [1] \"chr1\\t184577\\t184578\\t0.000\\t1\" \"chr1\\t191223\\t191224\\t0.000\\t1\" ## [3] \"chr1\\t191264\\t191265\\t0.000\\t1\" \"chr1\\t191307\\t191308\\t0.000\\t1\" ## [5] \"chr1\\t191491\\t191492\\t0.000\\t1\" \"chr1\\t191507\\t191508\\t0.000\\t1\" ## [7] \"chr1\\t191526\\t191527\\t0.000\\t1\" \"chr1\\t679950\\t679951\\t1.000\\t1\" ## [9] \"chr1\\t680064\\t680065\\t1.000\\t1\" ##  ## $cell1$`chrY:56877780-56882524` ##  [1] \"chrY\\t56877780\\t56877781\\t0.000\\t1\" \"chrY\\t56878350\\t56878351\\t0.000\\t1\" ##  [3] \"chrY\\t56878351\\t56878352\\t0.000\\t1\" \"chrY\\t56878431\\t56878432\\t0.000\\t1\" ##  [5] \"chrY\\t56879483\\t56879484\\t0.000\\t2\" \"chrY\\t56879535\\t56879536\\t0.000\\t2\" ##  [7] \"chrY\\t56879539\\t56879540\\t1.000\\t1\" \"chrY\\t56879724\\t56879725\\t0.000\\t1\" ##  [9] \"chrY\\t56879834\\t56879835\\t0.000\\t1\" \"chrY\\t56879863\\t56879864\\t1.000\\t1\" ## [11] \"chrY\\t56879915\\t56879916\\t1.000\\t1\" \"chrY\\t56879945\\t56879946\\t1.000\\t1\" ## [13] \"chrY\\t56881130\\t56881131\\t1.000\\t1\" \"chrY\\t56881926\\t56881927\\t1.000\\t1\" ## [15] \"chrY\\t56882523\\t56882524\\t0.000\\t1\" ##  ##  ## $cell2 ## $cell2$`chr1:184577-680065` ## character(0) ##  ## $cell2$`chrY:56877780-56882524` ##  [1] \"chrY\\t56878351\\t56878352\\t0.000\\t1\" \"chrY\\t56879482\\t56879483\\t1.000\\t1\" ##  [3] \"chrY\\t56879483\\t56879484\\t1.000\\t1\" \"chrY\\t56879534\\t56879535\\t1.000\\t1\" ##  [5] \"chrY\\t56879538\\t56879539\\t1.000\\t1\" \"chrY\\t56880322\\t56880323\\t0.000\\t1\" ##  [7] \"chrY\\t56880404\\t56880405\\t1.000\\t1\" \"chrY\\t56881129\\t56881130\\t0.000\\t1\" ##  [9] \"chrY\\t56881285\\t56881286\\t0.000\\t1\" \"chrY\\t56881364\\t56881365\\t1.000\\t1\" ## [11] \"chrY\\t56882344\\t56882345\\t0.000\\t1\" \"chrY\\t56882523\\t56882524\\t0.000\\t1\" ##  ##  ## $cell3 ## $cell3$`chr1:184577-680065` ## character(0) ##  ## $cell3$`chrY:56877780-56882524` ## [1] \"chrY\\t56879862\\t56879863\\t1.000\\t1\" \"chrY\\t56879914\\t56879915\\t0.500\\t2\" ## [3] \"chrY\\t56879944\\t56879945\\t1.000\\t1\" \"chrY\\t56879969\\t56879970\\t1.000\\t1\" ## [5] \"chrY\\t56879976\\t56879977\\t1.000\\t1\" \"chrY\\t56880322\\t56880323\\t0.000\\t1\" ## [7] \"chrY\\t56880359\\t56880360\\t0.000\\t1\" \"chrY\\t56881129\\t56881130\\t0.500\\t2\" ##  ##  ## $cell4 ## $cell4$`chr1:184577-680065` ##  [1] \"chr1\\t191003\\t191004\\t1.000\\t1\" \"chr1\\t191307\\t191308\\t1.000\\t1\" ##  [3] \"chr1\\t191438\\t191439\\t1.000\\t1\" \"chr1\\t191491\\t191492\\t1.000\\t1\" ##  [5] \"chr1\\t191722\\t191723\\t1.000\\t1\" \"chr1\\t191747\\t191748\\t1.000\\t1\" ##  [7] \"chr1\\t191776\\t191777\\t1.000\\t1\" \"chr1\\t628458\\t628459\\t1.000\\t1\" ##  [9] \"chr1\\t631433\\t631434\\t1.000\\t1\" \"chr1\\t631436\\t631437\\t1.000\\t1\" ##  ## $cell4$`chrY:56877780-56882524` ##  [1] \"chrY\\t56877780\\t56877781\\t0.000\\t1\" \"chrY\\t56877810\\t56877811\\t0.000\\t1\" ##  [3] \"chrY\\t56879834\\t56879835\\t0.000\\t1\" \"chrY\\t56879863\\t56879864\\t1.000\\t1\" ##  [5] \"chrY\\t56879915\\t56879916\\t1.000\\t1\" \"chrY\\t56879945\\t56879946\\t0.000\\t1\" ##  [7] \"chrY\\t56880045\\t56880046\\t0.500\\t2\" \"chrY\\t56880081\\t56880082\\t0.000\\t1\" ##  [9] \"chrY\\t56880092\\t56880093\\t0.500\\t2\" \"chrY\\t56880112\\t56880113\\t1.000\\t1\" ## [11] \"chrY\\t56880137\\t56880138\\t1.000\\t2\" \"chrY\\t56880142\\t56880143\\t0.500\\t2\" ## [13] \"chrY\\t56880323\\t56880324\\t0.000\\t1\" \"chrY\\t56880360\\t56880361\\t1.000\\t1\" ## [15] \"chrY\\t56880405\\t56880406\\t1.000\\t1\" \"chrY\\t56880518\\t56880519\\t0.000\\t1\" ## [17] \"chrY\\t56880715\\t56880716\\t0.000\\t2\" \"chrY\\t56880914\\t56880915\\t0.000\\t2\" ## [19] \"chrY\\t56881927\\t56881928\\t1.000\\t1\" \"chrY\\t56882345\\t56882346\\t1.000\\t1\""},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"wgbs-bed-files","dir":"Articles","previous_headings":"tabix()","what":"WGBS BED files","title":"An introduction to iscream","text":"Since iscream originally developed read Whole Genome Bisulfite Sequencing data, aligner argument automatically setting column names BISCUIT (Zhou et al. 2024), Bismark (Krueger Andrews 2011), BSBolt (Farrell et al. 2021).","code":"tabix_gr(bedfiles, regions, aligner = \"biscuit\") ## GRangesList object of length 4: ## $cell1 ## GRanges object with 24 ranges and 3 metadata columns: ##        seqnames    ranges strand |      beta  coverage        file ##           <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> ##    [1]     chr1    184578      * |         0         1       cell1 ##    [2]     chr1    191224      * |         0         1       cell1 ##    [3]     chr1    191265      * |         0         1       cell1 ##    [4]     chr1    191308      * |         0         1       cell1 ##    [5]     chr1    191492      * |         0         1       cell1 ##    ...      ...       ...    ... .       ...       ...         ... ##   [20]     chrY  56879916      * |         1         1       cell1 ##   [21]     chrY  56879946      * |         1         1       cell1 ##   [22]     chrY  56881131      * |         1         1       cell1 ##   [23]     chrY  56881927      * |         1         1       cell1 ##   [24]     chrY  56882524      * |         0         1       cell1 ##   ------- ##   seqinfo: 2 sequences from an unspecified genome; no seqlengths ##  ## ... ## <3 more elements>"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"summarize_regions","dir":"Articles","previous_headings":"","what":"summarize_regions()","title":"An introduction to iscream","text":"Using BED files regions, iscream can also summarize data within regions. requires providing index data columns want summarized column names output. summarizing functions run input column default - see ?summarize_regions supported functions. feature column contains genomic region coordinates, can set something informational names regions. can also select functions applied fun:","code":"summarize_regions(   bedfiles,   regions,   columns = c(4, 5),   col_names = c(\"beta\", \"coverage\") ) ## [18:21:25.484879] [iscream::summarize_regions] [info] Summarizing 2 regions from 4 bedfiles ## [18:21:25.484925] [iscream::summarize_regions] [info] using sum, mean, median, stddev, variance, min, max, range, count ## [18:21:25.484931] [iscream::summarize_regions] [info] with columns 4, 5 as beta, coverage ##                  feature  file beta.sum coverage.sum beta.mean coverage.mean ## 1     chr1:184577-680065 cell1      2.0            9 0.2222222      1.000000 ## 2 chrY:56877780-56882524 cell1      6.0           17 0.4000000      1.133333 ## 3     chr1:184577-680065 cell2       NA           NA        NA            NA ## 4 chrY:56877780-56882524 cell2      6.0           12 0.5000000      1.000000 ## 5     chr1:184577-680065 cell3       NA           NA        NA            NA ## 6 chrY:56877780-56882524 cell3      5.0           10 0.6250000      1.250000 ## 7     chr1:184577-680065 cell4     10.0           10 1.0000000      1.000000 ## 8 chrY:56877780-56882524 cell4      9.5           26 0.4750000      1.300000 ##   beta.median coverage.median beta.stddev coverage.stddev beta.variance ## 1        0.00               1   0.4409586       0.0000000     0.1944444 ## 2        0.00               1   0.5070926       0.3518658     0.2571429 ## 3          NA              NA          NA              NA            NA ## 4        0.50               1   0.5222330       0.0000000     0.2727273 ## 5          NA              NA          NA              NA            NA ## 6        0.75               1   0.4432026       0.4629100     0.1964286 ## 7        1.00               1   0.0000000       0.0000000     0.0000000 ## 8        0.50               1   0.4722566       0.4701623     0.2230263 ##   coverage.variance beta.min coverage.min beta.max coverage.max beta.range ## 1         0.0000000        0            1        1            1          1 ## 2         0.1238095        0            1        1            2          1 ## 3                NA       NA           NA       NA           NA         NA ## 4         0.0000000        0            1        1            1          1 ## 5                NA       NA           NA       NA           NA         NA ## 6         0.2142857        0            1        1            2          1 ## 7         0.0000000        1            1        1            1          0 ## 8         0.2210526        0            1        1            2          1 ##   coverage.range count ## 1              0     9 ## 2              1    15 ## 3             NA    NA ## 4              0    12 ## 5             NA    NA ## 6              1     8 ## 7              0    10 ## 8              1    20 names(regions) <- c(\"R1\", \"R2\") summarize_regions(   bedfiles,   regions,   fun = c(\"mean\", \"sum\"),   columns = 5,   col_names = \"coverage\" ) ## [18:21:25.574006] [iscream::summarize_regions] [info] Summarizing 2 regions from 4 bedfiles ## [18:21:25.574046] [iscream::summarize_regions] [info] using mean, sum ## [18:21:25.574050] [iscream::summarize_regions] [info] with columns 5 as coverage ##   feature  file coverage.mean coverage.sum ## 1      R1 cell1      1.000000            9 ## 2      R2 cell1      1.133333           17 ## 3      R1 cell2            NA           NA ## 4      R2 cell2      1.000000           12 ## 5      R1 cell3            NA           NA ## 6      R2 cell3      1.250000           10 ## 7      R1 cell4      1.000000           10 ## 8      R2 cell4      1.300000           26"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"wgbs-bed-files-1","dir":"Articles","previous_headings":"summarize_regions()","what":"WGBS BED files","title":"An introduction to iscream","text":"WGBS data specifically, can use summarize_meth_regions(), takes aligner argument correctly parse columns.","code":"summarize_meth_regions(   bedfiles,   regions,   aligner = \"biscuit\",   fun = c(\"mean\", \"sum\") ) ## [18:21:25.644694] [iscream::summarize_regions] [info] Summarizing 2 regions from 4 bedfiles ## [18:21:25.644721] [iscream::summarize_regions] [info] using mean, sum ## [18:21:25.644726] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, M ##   feature  file coverage.mean    M.mean coverage.sum M.sum ## 1      R1 cell1      1.000000 0.2222222            9     2 ## 2      R2 cell1      1.133333 0.4000000           17     6 ## 3      R1 cell2            NA        NA           NA    NA ## 4      R2 cell2      1.000000 0.5000000           12     6 ## 5      R1 cell3            NA        NA           NA    NA ## 6      R2 cell3      1.250000 0.7500000           10     6 ## 7      R1 cell4      1.000000 1.0000000           10    10 ## 8      R2 cell4      1.300000 0.6000000           26    12"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"make_mat","dir":"Articles","previous_headings":"","what":"make_mat()","title":"An introduction to iscream","text":"make_mat() makes matrix every row locus found least one input file columns input files. returns named list matrix, coordinates, file names can use analysis data structures. make_mat_se() returns RangedSummarizedExperiment, make_mat_gr() returns GRanges object. sparse data, can save memory sparse = TRUE, make_mat() make_mat_se().","code":"library(SummarizedExperiment) (mat <- make_mat_se(bedfiles, regions, column = 4, mat_name = \"beta\")) ## [18:21:27.906761] [iscream::query_all] [info] Querying 2 regions from 4 bedfiles ##  ## [18:21:27.907266] [iscream::query_all] [info] Creating metadata vectors ## [18:21:27.907328] [iscream::query_all] [info] 62 loci found - 9938 extra rows allocated with 0 resizes ## [18:21:27.907333] [iscream::query_all] [info] Creating dense matrix ## class: RangedSummarizedExperiment  ## dim: 62 4  ## metadata(0): ## assays(1): beta ## rownames: NULL ## rowData names(0): ## colnames(4): cell1 cell2 cell3 cell4 ## colData names(0): head(assay(mat), 10) ##       cell1 cell2 cell3 cell4 ##  [1,]     0     0   1.0     0 ##  [2,]     0     0   0.5     0 ##  [3,]     0     0   1.0     0 ##  [4,]     0     0   1.0     0 ##  [5,]     0     0   1.0     0 ##  [6,]     0     0   0.0     0 ##  [7,]     0     0   0.0     0 ##  [8,]     0     0   0.5     0 ##  [9,]     0     0   0.0     0 ## [10,]     0     0   0.0     0 mat <- make_mat(bedfiles, regions, column = 4, mat_name = \"beta\", sparse = TRUE) ## [18:21:28.026785] [iscream::query_all] [info] Querying 2 regions from 4 bedfiles ##  ## [18:21:28.027298] [iscream::query_all] [info] Creating metadata vectors ## [18:21:28.027340] [iscream::query_all] [info] 62 loci found - 9938 extra rows allocated with 0 resizes ## [18:21:28.027352] [iscream::query_all] [info] Creating sparse matrix head(mat$beta, 10) ## 10 x 4 sparse Matrix of class \"dgCMatrix\" ##       cell1 cell2 cell3 cell4 ##  [1,]     .     .   1.0     . ##  [2,]     .     .   0.5     . ##  [3,]     .     .   1.0     . ##  [4,]     .     .   1.0     . ##  [5,]     .     .   1.0     . ##  [6,]     .     .   .       . ##  [7,]     .     .   .       . ##  [8,]     .     .   0.5     . ##  [9,]     .     .   .       . ## [10,]     .     .   .       ."},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"wgbs-bed-files-2","dir":"Articles","previous_headings":"make_mat()","what":"WGBS BED files","title":"An introduction to iscream","text":"BSseq compatible object, use make_meth_mat returns list BSseq inputs. make BSseq object run information supported Bioconductor data structures see vignette(\"data_structures\"). example workflow using iscream examine transcription start site methylation vignette(\"TSS\").","code":"meth_mat <- make_mat(bedfiles, regions) do.call(BSseq, meth_mat)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/iscream.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"An introduction to iscream","text":"","code":"sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SummarizedExperiment_1.38.1 Biobase_2.68.0              ##  [3] MatrixGenerics_1.20.0       matrixStats_1.5.0           ##  [5] GenomicRanges_1.60.0        GenomeInfoDb_1.44.1         ##  [7] IRanges_2.42.0              S4Vectors_0.46.0            ##  [9] BiocGenerics_0.54.0         generics_0.1.4              ## [11] iscream_0.99.0              BiocStyle_2.36.0            ##  ## loaded via a namespace (and not attached): ##  [1] sass_0.4.10             SparseArray_1.8.1       lattice_0.22-7          ##  [4] digest_0.6.37           evaluate_1.0.4          grid_4.5.1              ##  [7] bookdown_0.43           fastmap_1.2.0           jsonlite_2.0.0          ## [10] Matrix_1.7-3            BiocManager_1.30.26     httr_1.4.7              ## [13] UCSC.utils_1.4.0        textshaping_1.0.1       jquerylib_0.1.4         ## [16] abind_1.4-8             cli_3.6.5               rlang_1.1.6             ## [19] crayon_1.5.3            XVector_0.48.0          parallelly_1.45.1       ## [22] DelayedArray_0.34.1     cachem_1.1.0            yaml_2.3.10             ## [25] S4Arrays_1.8.1          tools_4.5.1             parallel_4.5.1          ## [28] GenomeInfoDbData_1.2.14 R6_2.6.1                lifecycle_1.0.4         ## [31] fs_1.6.6                stringfish_0.17.0       ragg_1.4.0              ## [34] desc_1.4.3              pkgdown_2.1.3           RcppParallel_5.1.10     ## [37] bslib_0.9.0             data.table_1.17.8       Rcpp_1.1.0              ## [40] systemfonts_1.2.3       xfun_0.52               knitr_1.50              ## [43] htmltools_0.5.8.1       rmarkdown_2.29          compiler_4.5.1"},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/articles/manuscript_data.html","id":"datasets","dir":"Articles","previous_headings":"","what":"Datasets","title":"Manuscript data availabiliy","text":"Two datasets used produce figure paper: snmC-seq2 scWGBS data (Luo et al. 2018) single-cell benchmarks. bulk WGBS project lab datasets aligned BISCUIT (Zhou et al. 2024). produce Bismark BEDgraph files (Krueger Andrews 2011), used python script convert beta coverage value columns percentage methylation, unmethylated reads methylated read columns. Using GNU parallel: using iscream.paper package https://github.com/huishenlab/iscream.paper ran benchmarks produced figures.","code":"import sys import gzip  bedfile = sys.argv[1]  def bed2cov(line):     chr, start, end, beta, cov = line.split('\\t')     percent, meth, unmeth = convert(float(beta), int(cov))     return '\\t'.join([chr, start, start, str(percent), str(meth), str(unmeth)])  def convert(beta, cov):     percent = round(beta * 100)     meth = round(beta * cov)     unmeth = cov - meth     return [percent, meth, unmeth]  with gzip.open(bedfile, 'rt') as bed:     for line in bed:         print(bed2cov(line)) parallel python bed2cov.py <biscuit_path>/{} '>' <bismark_path>/{/.} ::: biscuit_path/*.bed.gz"},{"path":[]},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"input-bed-files","dir":"Articles","previous_headings":"Setup","what":"Input BED files","title":"Improving iscream performance","text":"Running vignette requires downloading 2GB single-cell whole genome bisulfite sequencing (WGBS) BED files tabix indices Zenodo record: https://zenodo.org/records/14733834. Select 100 human cell WGBS data snmC-seq2 (Luo et al. 2018) dataset:","code":"snmc_zip_path <- tempfile(\"snmcseq2\") snmc_dir <- tempdir() download.file(     \"https://zenodo.org/records/14733834/files/sc_beds.zip\",     destfile = snmc_zip_path ) unzip(snmc_zip_path, exdir = snmcseq2_dir)  genes_file <- tempfile(\"genes\") download.file(     \"https://zenodo.org/records/14733834/files/genes.bed\",     destfile = genes_file ) bedfiles <- list.files(   snmc_dir,   pattern = \"*.bed.gz$\",   full.names = TRUE )[1:100]"},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"regions","dir":"Articles","previous_headings":"Setup","what":"Regions","title":"Improving iscream performance","text":"’ll using 5000 gene body regions input:","code":"library(data.table) regions <- fread(   genes_file,   col.names = c(\"chr\", \"start\", \"end\", \"gene\") )[1:5000] head(regions) #>       chr    start      end   gene #>    <char>    <int>    <int> <char> #> 1:   chr1  1471764  1497848 ATAD3B #> 2:   chr1  3069167  3438621 PRDM16 #> 3:   chr1  2403963  2413797  PEX10 #> 4:   chr1 10472287 10630758  PEX14 #> 5:   chr1  2425979  2505532  PLCH2 #> 6:   chr1  9292893  9369532  SPSB1"},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"multithreading","dir":"Articles","previous_headings":"","what":"Multithreading","title":"Improving iscream performance","text":"iscream uses multithreading reduce querying runtime. number threads can set loading library. iscream read option loading can set .Rprofile Queries parallelized across input BED files. reduces runtime, increases memory usage data multiple files loaded memory time. information multithreading see ?set_threads().","code":"options(\"iscream.threads\" = 8) library(iscream) #> iscream using 8 threads based on 'options(iscream.threads)' but parallelly::availableCores() detects 16 possibly available threads. See `?set_threads` for information on multithreading before trying to use more."},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"tabix","dir":"Articles","previous_headings":"Multithreading","what":"tabix()","title":"Improving iscream performance","text":"tabix() queries regions BED files much like tabix shell command, supports multiple files can query parallel. Although fast, tabix() may seem unresponsive large queries parallel::mclapply() doesn’t show progression, progress bar development. iscream two tabix() implementations, one using command line tabix executable using htslib API. command line tool faster can stream file can read R htslib API stores strings memory slower. iscream look tabix executable startup fall back htslip API executable found. See ?tabix details information. 8 threads, retrieving 45,733,379 records across 100 files took 11.814 seconds.","code":"qt <- system.time(   tbx_query <- tabix(bedfiles, regions, col.names = c(\"beta\", \"coverage\")) ) tbx_query #>              chr     start       end  beta coverage            file #>           <char>     <int>     <int> <num>    <int>          <char> #>        1:   chr1    923949    923950 0.000        1 bisc_SRR6911624 #>        2:   chr1    923953    923954 0.000        1 bisc_SRR6911624 #>        3:   chr1    923959    923960 0.000        1 bisc_SRR6911624 #>        4:   chr1    923971    923972 0.000        1 bisc_SRR6911624 #>        5:   chr1    923973    923974 0.000        1 bisc_SRR6911624 #>       ---                                                           #> 45733375:   chr4 190179369 190179370 0.000        2 bisc_SRR6911723 #> 45733376:   chr4 190179686 190179687 1.000        1 bisc_SRR6911723 #> 45733377:   chr4 190179687 190179688 0.500        2 bisc_SRR6911723 #> 45733378:   chr4 190179753 190179754 1.000        1 bisc_SRR6911723 #> 45733379:   chr4 190179754 190179755 0.333        3 bisc_SRR6911723"},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"summarize_regions","dir":"Articles","previous_headings":"Multithreading","what":"summarize_regions","title":"Improving iscream performance","text":"get summary information gene bodies use summarize_regions, providing gene name column feature column: 8 threads, summarizing 45,733,379 records across 100 files took 4.948 seconds. tabix(), runtime reduces memory usage increases increasing thread counts.","code":"qt <- system.time(   summary_query <- summarize_regions(     bedfiles,     regions,     columns = 4,     col_names = \"beta\",     feature_col = \"gene\"   ) ) #> [10:51:04.214132] [iscream::summarize_regions] [info] Summarizing 5000 regions from 100 bedfiles #> [10:51:04.214257] [iscream::summarize_regions] [info] using sum, mean, median, stddev, variance, min, max, range, count #> [10:51:04.214269] [iscream::summarize_regions] [info] with columns 4 as beta head(summary_query) #>   feature            file beta.sum beta.mean beta.median beta.stddev #> 1  ATAD3B bisc_SRR6911624   85.000 0.8585859           1   0.3502215 #> 2  PRDM16 bisc_SRR6911624  723.500 0.5288743           1   0.4976973 #> 3   PEX10 bisc_SRR6911624   15.000 0.2419355           0   0.4317514 #> 4   PEX14 bisc_SRR6911624  198.000 0.7764706           1   0.4174294 #> 5   PLCH2 bisc_SRR6911624  184.333 0.7228745           1   0.4474832 #> 6   SPSB1 bisc_SRR6911624   64.000 0.8648649           1   0.3442015 #>   beta.variance beta.min beta.max beta.range count #> 1     0.1226551        0        1          1    99 #> 2     0.2477026        0        1          1  1368 #> 3     0.1864093        0        1          1    62 #> 4     0.1742473        0        1          1   255 #> 5     0.2002412        0        1          1   255 #> 6     0.1184746        0        1          1    74"},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"make_mat","dir":"Articles","previous_headings":"Multithreading","what":"make_mat","title":"Improving iscream performance","text":"make_mat() function queries stores every genomic location within input regions across input files. Unlike summarize_regions() output matrix dimensions unknown runtime. Although usually quite fast, number records falling input regions large overlaps files, can take long time. , gene bodies large final matrix can contain millions CpG loci. , sparse data, chances new loci found every file. Preallocating number rows, however, can drastically reduce runtime. Since got 45 million loci/CpGs BED files tabix query , can expect approximately 5 10 million unique loci single-cell WGBS data lower coverage bulk. already tabix query can get unique CpG count use preallocate matrix, reducing number matrix resizes. ’ll add 100,000 extra rows top existing count safe since every avoided resize cuts least couple seconds runtime. Making tabix queries can relatively quick way approximate CpG count dataset. haven’t done tabix query full dataset, can approximate many CpGs expect based CpG counts one file coverage WGBS method. make matrix beta-values 4th column: Making 7,276,107 x 100 matrix took 50.429 seconds.","code":"cpg.count <- tbx_query$start |> unique() |> length() qt <- system.time(meth_mat <- make_mat_se(   bedfiles,   regions,   column = 4,   sparse = TRUE,   prealloc = cpg.count + 1e5 )) #> [10:51:11.215841] [iscream::query_all] [info] Querying 5000 regions from 100 bedfiles #>  #> [10:51:51.998902] [iscream::query_all] [info] Creating metadata vectors #> [10:51:52.457885] [iscream::query_all] [info] 7276107 loci found - 16250 extra rows allocated with 0 resizes #> [10:51:57.284487] [iscream::query_all] [info] Creating sparse matrix meth_mat #> class: RangedSummarizedExperiment  #> dim: 7276107 100  #> metadata(0): #> assays(1): value #> rownames: NULL #> rowData names(0): #> colnames(100): bisc_SRR6911624 bisc_SRR6911625 ... bisc_SRR6911722 #>   bisc_SRR6911723 #> colData names(0):"},{"path":"https://huishenlab.github.io/iscream/dev/articles/performance.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Improving iscream performance","text":"","code":"sessionInfo() #> R version 4.5.0 (2025-04-11) #> Platform: x86_64-pc-linux-gnu #> Running under: AlmaLinux 9.6 (Sage Margay) #>  #> Matrix products: default #> BLAS/LAPACK: /usr/lib64/libopenblas-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.utf8        LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.utf8      LC_MONETARY=C.UTF-8    LC_MESSAGES=C.utf8     #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] iscream_0.99.0    data.table_1.17.6 #>  #> loaded via a namespace (and not attached): #>  [1] crayon_1.5.3                httr_1.4.7                  #>  [3] knitr_1.50                  xfun_0.52                   #>  [5] UCSC.utils_1.4.0            generics_0.1.4              #>  [7] DelayedArray_0.34.1         jsonlite_2.0.0              #>  [9] RcppParallel_5.1.10         SummarizedExperiment_1.38.1 #> [11] S4Vectors_0.46.0            stringfish_0.16.0           #> [13] stats4_4.5.0                MatrixGenerics_1.20.0       #> [15] Biobase_2.68.0              grid_4.5.0                  #> [17] abind_1.4-8                 evaluate_1.0.4              #> [19] IRanges_2.42.0              GenomeInfoDb_1.44.0         #> [21] compiler_4.5.0              Rcpp_1.1.0                  #> [23] XVector_0.48.0              lattice_0.22-7              #> [25] R6_2.6.1                    SparseArray_1.8.0           #> [27] parallelly_1.45.0           parallel_4.5.0              #> [29] GenomeInfoDbData_1.2.14     GenomicRanges_1.60.0        #> [31] Matrix_1.7-3                tools_4.5.0                 #> [33] matrixStats_1.5.0           S4Arrays_1.8.1              #> [35] BiocGenerics_0.54.0"},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"one-file","dir":"Articles","previous_headings":"","what":"One file","title":"iscream vs Rsamtools::scanTabix","text":"tabix raw = TRUE scanTabix produce list unparsed raw strings. result identical. tabix vs scanTabix raw string output 1 file","code":"bench_1_raw <- microbenchmark(   `rsamtools 1 file raw` = rq <- scanTabix(methscan_files[1], param = mouse_promoters.gr),   `iscream 1 file raw` = iq <- tabix(methscan_files[1], mouse_promoters, raw = TRUE),   times = 3 ) bench_1_raw ## Unit: milliseconds ##                  expr        min         lq      mean     median         uq ##  rsamtools 1 file raw 1826.82051 1967.86772 2215.0109 2108.91493 2409.10609 ##    iscream 1 file raw   78.92343   79.86577   83.4658   80.80811   85.73699 ##         max neval ##  2709.29725     3 ##    90.66587     3 autoplot(bench_1_raw) iq[1:5] ## $`1:3669498-3673498` ## character(0) ##  ## $`1:4407241-4411241` ## character(0) ##  ## $`1:4494413-4498413` ## character(0) ##  ## $`1:4783739-4787739` ## [1] \"1\\t4785488\\t4785488\\t0.000000\\t0\\t2\"   ## [2] \"1\\t4785513\\t4785513\\t0.000000\\t0\\t2\"   ## [3] \"1\\t4785522\\t4785522\\t0.000000\\t0\\t2\"   ## [4] \"1\\t4785533\\t4785533\\t0.000000\\t0\\t2\"   ## [5] \"1\\t4786780\\t4786780\\t100.000000\\t1\\t0\" ## [6] \"1\\t4786886\\t4786886\\t100.000000\\t1\\t0\" ## [7] \"1\\t4786958\\t4786958\\t100.000000\\t1\\t0\" ##  ## $`1:4805823-4809823` ## [1] \"1\\t4806176\\t4806176\\t100.000000\\t1\\t0\" ## [2] \"1\\t4806221\\t4806221\\t100.000000\\t1\\t0\" ## [3] \"1\\t4807572\\t4807572\\t0.000000\\t0\\t1\"   ## [4] \"1\\t4807669\\t4807669\\t0.000000\\t0\\t2\"   ## [5] \"1\\t4807682\\t4807682\\t0.000000\\t0\\t2\"   ## [6] \"1\\t4807872\\t4807872\\t0.000000\\t0\\t1\"   ## [7] \"1\\t4807890\\t4807890\\t0.000000\\t0\\t1\"   ## [8] \"1\\t4807940\\t4807940\\t0.000000\\t0\\t1\"   ## [9] \"1\\t4807950\\t4807950\\t0.000000\\t0\\t1\" all.equal(iq, rq) ## [1] TRUE"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"multiple-files","dir":"Articles","previous_headings":"","what":"Multiple files","title":"iscream vs Rsamtools::scanTabix","text":"tabix can also take multiple files call. returns raw strings, input file list ’s . scanTabix support .","code":"bench_30_raw <- microbenchmark(   `iscream 30 files raw` = iq <- tabix(methscan_files, mouse_promoters, raw = TRUE),   times = 3 ) bench_30_raw ## Unit: seconds ##                  expr      min       lq     mean   median       uq      max ##  iscream 30 files raw 1.993962 2.015125 2.129326 2.036288 2.197008 2.357727 ##  neval ##      3 names(iq) ##  [1] \"cell_01\" \"cell_02\" \"cell_03\" \"cell_04\" \"cell_05\" \"cell_06\" \"cell_07\" ##  [8] \"cell_08\" \"cell_09\" \"cell_10\" \"cell_11\" \"cell_12\" \"cell_13\" \"cell_14\" ## [15] \"cell_15\" \"cell_16\" \"cell_17\" \"cell_18\" \"cell_19\" \"cell_20\" \"cell_21\" ## [22] \"cell_22\" \"cell_23\" \"cell_24\" \"cell_25\" \"cell_26\" \"cell_27\" \"cell_28\" ## [29] \"cell_29\" \"cell_30\" iq[[\"cell_01\"]][1:5] ## $`1:3669498-3673498` ## character(0) ##  ## $`1:4407241-4411241` ## character(0) ##  ## $`1:4494413-4498413` ## character(0) ##  ## $`1:4783739-4787739` ## [1] \"1\\t4785488\\t4785488\\t0.000000\\t0\\t2\"   ## [2] \"1\\t4785513\\t4785513\\t0.000000\\t0\\t2\"   ## [3] \"1\\t4785522\\t4785522\\t0.000000\\t0\\t2\"   ## [4] \"1\\t4785533\\t4785533\\t0.000000\\t0\\t2\"   ## [5] \"1\\t4786780\\t4786780\\t100.000000\\t1\\t0\" ## [6] \"1\\t4786886\\t4786886\\t100.000000\\t1\\t0\" ## [7] \"1\\t4786958\\t4786958\\t100.000000\\t1\\t0\" ##  ## $`1:4805823-4809823` ## [1] \"1\\t4806176\\t4806176\\t100.000000\\t1\\t0\" ## [2] \"1\\t4806221\\t4806221\\t100.000000\\t1\\t0\" ## [3] \"1\\t4807572\\t4807572\\t0.000000\\t0\\t1\"   ## [4] \"1\\t4807669\\t4807669\\t0.000000\\t0\\t2\"   ## [5] \"1\\t4807682\\t4807682\\t0.000000\\t0\\t2\"   ## [6] \"1\\t4807872\\t4807872\\t0.000000\\t0\\t1\"   ## [7] \"1\\t4807890\\t4807890\\t0.000000\\t0\\t1\"   ## [8] \"1\\t4807940\\t4807940\\t0.000000\\t0\\t1\"   ## [9] \"1\\t4807950\\t4807950\\t0.000000\\t0\\t1\" scanTabix(methscan_files, param = GRanges(mouse_promoters)) ## Error in h(simpleError(msg, call)): error in evaluating the argument 'file' in selecting a method for function 'scanTabix': 'file' must be length 1"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"parsing-records-into-a-data-frame","dir":"Articles","previous_headings":"","what":"Parsing records into a data frame","title":"iscream vs Rsamtools::scanTabix","text":"parsed data frame useful list raw strings - use tabix() instead tabix_raw(). scanTabix, custom function parses list strings make similar data frame: column types different data identical. tabix vs scanTabix parsed data frame 1 file","code":"rtbx <- function(bed) {   q <- scanTabix(bed, param = GRanges(mouse_promoters)) |>     lapply(strsplit, split = \"\\t\") |>     Filter(function(i) length(i) != 0, x = _) |>     unlist(recursive = FALSE) |>     do.call(rbind, args = _) |>     as.data.table() |>     setnames(c(\"chr\", \"start\", \"end\", paste0(\"V\", 1:3)))   q }  bench_1_df <- microbenchmark(   `rsamtools 1 file data frame` = rq <- rtbx(methscan_files[1]),   `iscream 1 file data frame` = iq <- tabix(methscan_files[1], mouse_promoters),   times = 3 ) rq ##           chr     start       end         V1     V2     V3 ##        <char>    <char>    <char>     <char> <char> <char> ##     1:      1   4785488   4785488   0.000000      0      2 ##     2:      1   4785513   4785513   0.000000      0      2 ##     3:      1   4785522   4785522   0.000000      0      2 ##     4:      1   4785533   4785533   0.000000      0      2 ##     5:      1   4786780   4786780 100.000000      1      0 ##    ---                                                     ## 79900:      X 168673566 168673566   0.000000      0      1 ## 79901:      X 168673577 168673577   0.000000      0      1 ## 79902:      X 168674670 168674670   0.000000      0      1 ## 79903:      X 168675047 168675047   0.000000      0      1 ## 79904:      X 169318831 169318831 100.000000      1      0 iq ##           chr     start       end    V1    V2    V3 ##        <char>     <int>     <int> <num> <int> <int> ##     1:      1   4785488   4785488     0     0     2 ##     2:      1   4785513   4785513     0     0     2 ##     3:      1   4785522   4785522     0     0     2 ##     4:      1   4785533   4785533     0     0     2 ##     5:      1   4786780   4786780   100     1     0 ##    ---                                              ## 79900:      X 168673566 168673566     0     0     1 ## 79901:      X 168673577 168673577     0     0     1 ## 79902:      X 168674670 168674670     0     0     1 ## 79903:      X 168675047 168675047     0     0     1 ## 79904:      X 169318831 169318831   100     1     0 all.equal(iq, rq, check.attributes = F) ## [1] \"Datasets have different column modes. First 3: start(numeric!=character) end(numeric!=character) V1(numeric!=character)\" bench_1_df ## Unit: milliseconds ##                         expr       min        lq      mean    median        uq ##  rsamtools 1 file data frame 2984.2747 3060.8480 3159.9506 3137.4213 3247.7886 ##    iscream 1 file data frame  143.3846  147.2966  161.2119  151.2086  170.1255 ##        max neval ##  3358.1559     3 ##   189.0425     3 autoplot(bench_1_df)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"multiple-files-as-data-frame","dir":"Articles","previous_headings":"","what":"Multiple files as data frame","title":"iscream vs Rsamtools::scanTabix","text":"can try query multiple BED files using Rsamtools function 8 cores like iscream : tabix vs scanTabix parsed data frame 30 files","code":"partbx <- function(bedfiles) {   mclapply(     methscan_files,     function(bed) {       query <- rtbx(bed)[, file := tools::file_path_sans_ext(basename(bed), compression = TRUE)][]       setnames(query, c(\"chr\", \"start\", \"end\", \"beta\", \"M\", \"U\", \"file\"))       query     },     mc.cores = 8   ) |>     rbindlist() }  bench_30_df <- microbenchmark(   `rsamtools 30 file data frame` = rq <- partbx(methscan_files[1]),   `iscream 30 file data frame` = iq <- tabix(methscan_files[1], mouse_promoters, col.names = c(\"beta\", \"M\", \"U\")),   times = 3 ) bench_30_df ## Unit: milliseconds ##                          expr        min         lq       mean     median ##  rsamtools 30 file data frame 25345.3997 26556.0112 28790.6806 27766.6228 ##    iscream 30 file data frame   137.4796   139.6301   144.6862   141.7806 ##          uq        max neval ##  30513.3211 33260.0193     3 ##    148.2894   154.7983     3 autoplot(bench_30_df)"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"all-benchmarks","dir":"Articles","previous_headings":"Multiple files as data frame","what":"All benchmarks","title":"iscream vs Rsamtools::scanTabix","text":"","code":"bench_all <- rbind(bench_1_raw, bench_30_raw, bench_1_df, bench_30_raw, bench_30_df)  bench.dt <- as.data.table(bench_all)[, .(   time       = time / 1000000,   package    = fifelse(grepl(\"iscream\", expr), \"iscream\", \"rsamtools\"),   files      = fifelse(grepl(\"1\", expr), 1, 30),   data.frame = fifelse(grepl(\"raw\", expr), FALSE, TRUE) )][,   package := paste(package, fifelse(data.frame, \"df\", \"raw\")) ]  plt <- ggplot(bench.dt, aes(x = package, y = time, color = as.factor(files))) +     geom_boxplot() +     labs(x = \"Package and return type\") +     scale_color_discrete(name = \"File count\") +     theme_minimal()"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"runtime","dir":"Articles","previous_headings":"Multiple files as data frame > All benchmarks","what":"Runtime","title":"iscream vs Rsamtools::scanTabix","text":"Comparing benchmarked iscream Rsamtools querying runtimes","code":"plt + labs(y = \"Runtime (milliseconds)\")"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"runtime-log-scale","dir":"Articles","previous_headings":"Multiple files as data frame > All benchmarks","what":"Runtime log scale","title":"iscream vs Rsamtools::scanTabix","text":"log10 scaled runtime benchmarks run","code":"plt + scale_y_log10() + labs(y = \"log10 Runtime (milliseconds)\")"},{"path":"https://huishenlab.github.io/iscream/dev/articles/tabix.html","id":"session-info","dir":"Articles","previous_headings":"Multiple files as data frame","what":"Session info","title":"iscream vs Rsamtools::scanTabix","text":"","code":"sessionInfo() ## R version 4.4.3 (2025-02-28) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.2 LTS ##  ## Matrix products: default ## BLAS/LAPACK: /nix/store/6kknwpcf8fl7ihkkxmdb6p764kdn443n-blas-3/lib/libblas.so.3;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: America/Detroit ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] parallel  stats4    stats     graphics  grDevices utils     datasets  ## [8] methods   base      ##  ## other attached packages: ##  [1] ggplot2_3.5.1         microbenchmark_1.4.10 Rsamtools_2.22.0      ##  [4] Biostrings_2.74.1     XVector_0.46.0        GenomicRanges_1.58.0  ##  [7] GenomeInfoDb_1.42.3   IRanges_2.40.1        S4Vectors_0.44.0      ## [10] BiocGenerics_0.52.0   data.table_1.17.0     iscream_0.1.0.9000    ##  ## loaded via a namespace (and not attached): ##  [1] Matrix_1.7-2            gtable_0.3.5            jsonlite_1.8.8          ##  [4] highr_0.11              compiler_4.4.3          crayon_1.5.3            ##  [7] Rcpp_1.0.14             bitops_1.0-9            scales_1.3.0            ## [10] BiocParallel_1.40.0     lattice_0.22-6          R6_2.5.1                ## [13] labeling_0.4.3          knitr_1.47              tibble_3.2.1            ## [16] munsell_0.5.1           stringfish_0.16.0       GenomeInfoDbData_1.2.13 ## [19] pillar_1.10.1           rlang_1.1.4             xfun_0.51               ## [22] RcppParallel_5.1.10     cli_3.6.3               withr_3.0.0             ## [25] magrittr_2.0.3          zlibbioc_1.52.0         grid_4.4.3              ## [28] lifecycle_1.0.4         vctrs_0.6.5             evaluate_0.24.0         ## [31] glue_1.7.0              farver_2.1.2            codetools_0.2-20        ## [34] colorspace_2.1-1        parallelly_1.42.0       httr_1.4.7              ## [37] pkgconfig_2.0.3         tools_4.4.3             UCSC.utils_1.2.0"},{"path":"https://huishenlab.github.io/iscream/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"James Eapen. Author, maintainer. Jacob Morrison. Author. Nathan Spix. Contributor. Hui Shen. Author, thesis advisor, funder.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Eapen J, Morrison J, Shen H (2025). iscream: Fast memory efficient package make BED file queries, summaries matrices. R package version 0.99.0, https://huishenlab.github.io/iscream/.","code":"@Manual{,   title = {iscream: Fast and memory efficient package to make BED file queries, summaries and matrices},   author = {James Eapen and Jacob Morrison and Hui Shen},   year = {2025},   note = {R package version 0.99.0},   url = {https://huishenlab.github.io/iscream/}, }"},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"iscream-","dir":"","previous_headings":"","what":"iscream","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"iscream aims efficiently read data BED file formats usable packages. Using htslib, iscream can query genomic regions like tabix, summarize queried data make matrices, specific support WGBS BED files aligned BISCUIT, Bismark BSBolt. Analysis visualization Whole Genome Bisulfite Sequencing (WGBS)1 data requires reading aligned sequencing data formats existing packages like BSseq scMET can analyze. Getting data -disk BED files matrix methylation values can difficult , nearly 30 million CpGs, WGBS data can quite large. iscream makes importing WGBS data targeted exploration analysis faster memory efficient.","code":""},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"htslib--117","dir":"","previous_headings":"Dependencies","what":"htslib >= 1.17","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"iscream depends htslib header files. may installed package manager: ubuntu/debian: libhts-dev fedora/RHEL: htslib-devel brew: htslib nixpkgs: htslib conda: bioconda::htslib built manually: https://www.htslib.org/download/. iscream can use Rhtslib htslib source recommend installing htslib libdeflate support optimal performance - see vignette(\"htslib\") information. header files may also found among HPC modules - make sure PKG_CONFIG_PATH environment variable includes pkgconfig location installation htslib. can verify htslib development libraries installed pkg-config:","code":"# set path if necessary export PKG_CONFIG_PATH=[path to htslib installation] # verify that htslib can be found pkg-config --cflags --libs htslib"},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"tabix","dir":"","previous_headings":"Dependencies > htslib >= 1.17","what":"tabix","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"htslib installations include tabix executable (Ubuntu need install libhts-dev tabix). iscream work without tabix, tabix() function faster executable installed.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"gcc--940","dir":"","previous_headings":"Dependencies","what":"GCC >= 9.4.0","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"GNU GCC must installed OpenMP support. usually installed default Linux systems, may need manually installed MacOS use iscream multiple threads2.","code":""},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"bioconductor","dir":"","previous_headings":"Installation","what":"Bioconductor","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") BiocManager::install(\"iscream\")"},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"github","dir":"","previous_headings":"Installation","what":"GitHub","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"can install development version Github cloning repo running can also use R devtools package: pak:","code":"git clone https://github.com/huishenlab/iscream R CMD INSTALL iscream devtools::install_github(\"huishenlab/iscream\") pak::pkg_install(\"huishenlab/iscream\")"},{"path":"https://huishenlab.github.io/iscream/dev/index.html","id":"usage","dir":"","previous_headings":"Installation","what":"Usage","title":"Fast and memory efficient package to make BED file queries, summaries and matrices","text":"See quick start guide overview iscream’s functionality function reference available functions. Bug reports may submitted GitHub issues.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_query_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Query all CpG info into M and coverage matrices — Cpp_query_all","title":"Query all CpG info into M and coverage matrices — Cpp_query_all","text":"Query CpG info M coverage matrices","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_query_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query all CpG info into M and coverage matrices — Cpp_query_all","text":"","code":"Cpp_query_all(   bedfiles,   regions,   aligner,   valInd,   merged,   sparse,   prealloc,   nthreads )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_query_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query all CpG info into M and coverage matrices — Cpp_query_all","text":"bedfiles vector BED files regions vector regions aligner aligner used make WGBS BED files, make_bsseq_mat valInd index data column needed matrix, make_mat merged Whether input strands merged/collapsed prealloc number rows initialize matrices nthreads Set number threads use overriding \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_query_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query all CpG info into M and coverage matrices — Cpp_query_all","text":"list one two matrices, chromosome, position, filename vectors","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_set_log_level.html","id":null,"dir":"Reference","previous_headings":"","what":"spdlog Logging Lever Setter — Cpp_set_log_level","title":"spdlog Logging Lever Setter — Cpp_set_log_level","text":"helper function turn logging level given string current logging level","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_set_log_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spdlog Logging Lever Setter — Cpp_set_log_level","text":"","code":"Cpp_set_log_level(name)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_set_log_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spdlog Logging Lever Setter — Cpp_set_log_level","text":"name string logging level. Value understood , decreasing verbosity ‘trace’, ‘debug’, ‘info’, ‘warning’, ‘error’, ‘critical’, ‘’. Unrecognised names equivalent ‘’.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_set_log_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spdlog Logging Lever Setter — Cpp_set_log_level","text":"Nothing returned.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_summarize_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","title":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","text":"function called summarize_regions() since sanity checks C++ side.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_summarize_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","text":"","code":"Cpp_summarize_regions(   bedfiles,   regions,   fun_vec,   col_indices,   col_names,   aligner,   mval = FALSE,   region_rownames = FALSE,   nthreads = 1L )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_summarize_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","text":"bedfiles vector BED file paths regions vector genomic regions fun_vec Vector armadillo-supported stats functions apply CpGs ' regions: \"sum\", \"mean\", \"median\", \"stddev\", \"variance\" \"count\", \"min\",\"max\", \"range\". col_indices vector genomic regions col_names vector genomic regions mval Calculates M values TRUE, use beta values FALSE region_rownames Whether set rownames regions strings. necessary regions vector unnamed. names, \"feature\" column set names rownames set regions string nthreads Number cores use. See details.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_summarize_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","text":"summary data.frame","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/Cpp_summarize_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Apply a function over BED file records within genomic features — Cpp_summarize_regions","text":"optimal number threads depends number bedfiles, set half available OpenMP cores. See ?get_threads details. can manaully set set_threads().","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_files_exist.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that files exist — check_files_exist","title":"Check that files exist — check_files_exist","text":"Check files exist","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_files_exist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that files exist — check_files_exist","text":"","code":"check_files_exist(files_vec, error_file_prefix = \"Bedfile\")"},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_files_exist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that files exist — check_files_exist","text":"files_vec vector file paths error_file_prefix Error message prefix 'Bedfile' vs 'Tabix file'","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_files_exist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that files exist — check_files_exist","text":"TRUE input BED files associated tabix index file. FALSE ","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_thread_count.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that the required threads are available — check_thread_count","title":"Check that the required threads are available — check_thread_count","text":"Check required threads available","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_thread_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that the required threads are available — check_thread_count","text":"","code":"check_thread_count(   n_threads,   avail_threads = availableCores(),   opt_set = FALSE )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_thread_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that the required threads are available — check_thread_count","text":"n_threads number threads check availability avail_threads number threads available system. Defaults parallelly::availableCores() opt_set Whether iscream.threads options set","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/check_thread_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that the required threads are available — check_thread_count","text":"n_threads requested number threads available stops ","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_df_string.html","id":null,"dir":"Reference","previous_headings":"","what":"DataFrame to region strings — get_df_string","title":"DataFrame to region strings — get_df_string","text":"Convert DataFrame vector strings. Set feature names \"name\" column","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_df_string.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DataFrame to region strings — get_df_string","text":"","code":"get_df_string(regions_df, feature_col = NULL)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_df_string.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DataFrame to region strings — get_df_string","text":"regions_df data frame \"chr\", \"start\" \"end\" columns feature_col data frame column use names output string vector","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_df_string.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DataFrame to region strings — get_df_string","text":"character vector","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_df_string.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DataFrame to region strings — get_df_string","text":"","code":"(df <- data.frame(chr = c(\"chr1\", \"chr2\"), start = c(1, 5), end = c(4, 10))) #>    chr start end #> 1 chr1     1   4 #> 2 chr2     5  10 get_df_string(df) #> [1] \"chr1:1-4\"  \"chr2:5-10\""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_granges_string.html","id":null,"dir":"Reference","previous_headings":"","what":"GRanges to region strings — get_granges_string","title":"GRanges to region strings — get_granges_string","text":"GRanges region strings","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_granges_string.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GRanges to region strings — get_granges_string","text":"","code":"get_granges_string(gr)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_granges_string.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GRanges to region strings — get_granges_string","text":"gr GRanges object","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_granges_string.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GRanges to region strings — get_granges_string","text":"character vector","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_granges_string.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GRanges to region strings — get_granges_string","text":"","code":"if (requireNamespace(\"GenomicRanges\", quietly = TRUE)) {   get_granges_string(GenomicRanges::GRanges(c(\"chr1:1-10\", \"chr2:15-20\"))) } #> [1] \"chr1:1-10\"  \"chr2:15-20\""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_threads.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the number of available threads — get_threads","title":"Get the number of available threads — get_threads","text":"Gets number threads iscream currently set use, whether \"iscream.threads\" option set many threads available use. set number threads use set_threads() set iscream.threads option ~/.Rprofile. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_threads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the number of available threads — get_threads","text":"","code":"get_threads()"},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_threads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the number of available threads — get_threads","text":"named vector: use_threads = number threads iscream use opt_set = whether option set user avail_threads = number available threads reported parallelly::availableCores","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/get_threads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the number of available threads — get_threads","text":"","code":"get_threads() #>   use_threads       opt_set avail_threads  #>             1             1             4"},{"path":"https://huishenlab.github.io/iscream/dev/reference/htslib_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Get htslib version and available features — htslib_version","title":"Get htslib version and available features — htslib_version","text":"Returns version htslib used iscream whether features libdeflate support available. information may always correspond htslib version used iscream's installation different htslib version available linking runtime.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/htslib_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get htslib version and available features — htslib_version","text":"","code":"htslib_version()"},{"path":"https://huishenlab.github.io/iscream/dev/reference/htslib_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get htslib version and available features — htslib_version","text":"None","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/htslib_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get htslib version and available features — htslib_version","text":"","code":"htslib_version() #> 1.19 #> build=configure libcurl=yes S3=yes GCS=yes libdeflate=yes lzma=yes bzip2=yes plugins=yes plugin-path=/usr/local/lib/htslib:/usr/local/libexec/htslib:/usr/lib/x86_64-linux-gnu/htslib: htscodecs=1.6.0"},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"Queries provided regions produces M/beta Coverage matrices genomic positions. Parallelized across files using threads \"iscream.threads\" option. output make_bsseq_mat may used create BSseq object: .call(BSseq, make_bsseq_mat(...)).","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"","code":"make_bsseq_mat(   bedfiles,   regions,   aligner = \"biscuit\",   mval = TRUE,   merged = TRUE,   sparse = FALSE,   prealloc = 10000,   nthreads = NULL )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"bedfiles vector BED file paths regions vector, data frame GenomicRanges genomic regions. See details. aligner aligner used produce BED files - one \"biscuit\", \"bismark\", \"bsbolt\". mval Whether return M-values beta-values coverage matrix. Defaults M-value. Set mval=FALSE get beta value matrix. merged Whether input strands merged/collapsed sparse Whether return sparse matrix prealloc number rows initialize matrices . number loci approximately known, can reduce runtime fewer resizes need made. nthreads Set number threads use. Overrides \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"named list coverage either beta- M-value matrix character vector chromosomes numeric vector corresponding CpG base positions character vector input sample names","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"input regions may string vector form \"chr:start-end\" GRanges object. data frame provided, must \"chr\", \"start\", \"end\" columns.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"bitpacking-limits","dir":"Reference","previous_headings":"","what":"Bitpacking limits","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"coverage values exceed 32,767, upper limit 16-bit signed integer, capped limit. Beta values also capped similarly, values bug aligner produced data.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_bsseq_mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make M/beta and coverage matrices from WGBS BED files — make_bsseq_mat","text":"","code":"bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE) # examine the BED files colnames <- c(\"chr\", \"start\", \"end\", \"beta\", \"coverage\") lapply(bedfiles, function(i) knitr::kable(read.table(i, col.names = colnames))) #> [[1]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        1| #> |chr1 |     4|   6|  0.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    10|  12|  1.0|        2| #> |chr1 |    12|  14|  1.0|        3| #>  #> [[2]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|    0|        2| #> |chr1 |     4|   6|    1|        2| #> |chr1 |     6|   8|    1|        1| #> |chr1 |    10|  12|    0|        2| #> |chr1 |    12|  14|    1|        1| #>  #> [[3]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     2|   4|    1|        2| #> |chr1 |     6|   8|    0|        2| #> |chr1 |     8|  10|    1|        1| #>  #> [[4]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    12|  14|  1.0|        1| #>   # make a vector of regions regions <- c(\"chr1:1-6\", \"chr1:7-10\", \"chr1:11-14\") make_bsseq_mat(bedfiles, regions) #> [18:21:01.887242] [iscream::query_all] [info] Querying 3 regions from 4 bedfiles #>  #> [18:21:01.887676] [iscream::query_all] [info] Creating metadata vectors #> [18:21:01.887729] [iscream::query_all] [info] 7 loci found - 9993 extra rows allocated with 0 resizes #> [18:21:01.887735] [iscream::query_all] [info] Creating dense matrix #> $M #>      a b c d #> [1,] 1 0 0 1 #> [2,] 1 0 2 2 #> [3,] 0 2 0 0 #> [4,] 0 1 0 0 #> [5,] 1 0 1 1 #> [6,] 2 0 0 0 #> [7,] 3 1 0 1 #>  #> $Cov #>      a b c d #> [1,] 1 2 0 1 #> [2,] 1 0 2 2 #> [3,] 2 2 0 0 #> [4,] 1 1 2 1 #> [5,] 2 0 1 2 #> [6,] 2 2 0 0 #> [7,] 3 1 0 1 #>  #> $pos #> [1]  0  2  4  6  8 10 12 #>  #> $chr #> [1] \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" #>  #> $sampleNames #> [1] \"a\" \"b\" \"c\" \"d\" #>  # for BSseq object run if (FALSE) { # \\dontrun{ library(bsseq) do.call(BSseq, make_bsseq_mat(bedfiles, regions)) } # }"},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a matrix from a numeric column of BED files — make_mat","title":"Make a matrix from a numeric column of BED files — make_mat","text":"Queries provided regions produces matrix along genomic positions named list (make_mat()), RangedSummarizedExperiment (make_mat_se()), GRanges (make_mat_gr()). Parallelized across files using threads \"iscream.threads\" option.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a matrix from a numeric column of BED files — make_mat","text":"","code":"make_mat(   bedfiles,   regions,   column,   mat_name = \"value\",   sparse = FALSE,   prealloc = 10000,   nthreads = NULL )  make_mat_se(   bedfiles,   regions,   column,   mat_name = \"value\",   sparse = FALSE,   prealloc = 10000,   nthreads = NULL )  make_mat_gr(   bedfiles,   regions,   column,   mat_name = \"value\",   prealloc = 10000,   nthreads = NULL )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a matrix from a numeric column of BED files — make_mat","text":"bedfiles vector BED file paths regions vector, data frame GenomicRanges genomic regions. See details. column index data column needed matrix mat_name name matrix returned object sparse Whether return sparse matrix prealloc number rows initialize matrices . number loci approximately known, can reduce runtime fewer resizes need made. nthreads Set number threads use. Overrides \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a matrix from a numeric column of BED files — make_mat","text":"make_mat(): named list matrix value interest character vector chromosomes numeric vector base positions character vector input sample BED file names make_mat_gr(): GenomicRanges available, GRanges make_mat_se(): SummarizedExperiment available, RangedSummarizedExperiment","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make a matrix from a numeric column of BED files — make_mat","text":"input regions may string vector form \"chr:start-end\" GRanges object. data frame provided, must \"chr\", \"start\", \"end\" columns.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/make_mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make a matrix from a numeric column of BED files — make_mat","text":"","code":"bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE) # examine the bedfiles colnames <- c(\"chr\", \"start\", \"end\", \"beta\", \"coverage\") lapply(bedfiles, function(i) knitr::kable(read.table(i, col.names = colnames))) #> [[1]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        1| #> |chr1 |     4|   6|  0.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    10|  12|  1.0|        2| #> |chr1 |    12|  14|  1.0|        3| #>  #> [[2]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|    0|        2| #> |chr1 |     4|   6|    1|        2| #> |chr1 |     6|   8|    1|        1| #> |chr1 |    10|  12|    0|        2| #> |chr1 |    12|  14|    1|        1| #>  #> [[3]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     2|   4|    1|        2| #> |chr1 |     6|   8|    0|        2| #> |chr1 |     8|  10|    1|        1| #>  #> [[4]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    12|  14|  1.0|        1| #>   # make a vector of regions regions <- c(\"chr1:1-6\", \"chr1:7-10\", \"chr1:11-14\") # make matrix of beta values make_mat(bedfiles, regions, column = 4) #> [18:21:05.033881] [iscream::query_all] [info] Querying 3 regions from 4 bedfiles #>  #> [18:21:05.034264] [iscream::query_all] [info] Creating metadata vectors #> [18:21:05.034299] [iscream::query_all] [info] 7 loci found - 9993 extra rows allocated with 0 resizes #> [18:21:05.034304] [iscream::query_all] [info] Creating dense matrix #> $value #>        a b c   d #> [1,] 1.0 0 0 1.0 #> [2,] 1.0 0 1 1.0 #> [3,] 0.0 1 0 0.0 #> [4,] 0.0 1 0 0.0 #> [5,] 0.5 0 1 0.5 #> [6,] 1.0 0 0 0.0 #> [7,] 1.0 1 0 1.0 #>  #> $pos #> [1]  0  2  4  6  8 10 12 #>  #> $chr #> [1] \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" \"chr1\" #>  #> $sampleNames #> [1] \"a\" \"b\" \"c\" \"d\" #>"},{"path":"https://huishenlab.github.io/iscream/dev/reference/query_chroms.html","id":null,"dir":"Reference","previous_headings":"","what":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","title":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","text":"Query chromosomes seqnames vector BED files","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/query_chroms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","text":"","code":"query_chroms(bedfiles, nthreads = NULL)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/query_chroms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","text":"bedfiles vector BED file paths nthreads Set number threads use overriding \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/query_chroms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","text":"vector seqnames","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/query_chroms.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query the chromosomes or seqnames from a vector of BED files — query_chroms","text":"","code":"bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE) query_chroms(bedfiles) #> [1] \"chr1\""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_log_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Set and get logging level — set_log_level","title":"Set and get logging level — set_log_level","text":"Set get logging level","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_log_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set and get logging level — set_log_level","text":"","code":"set_log_level(level = \"info\")  get_log_level()"},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_log_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set and get logging level — set_log_level","text":"level logging verbosity level use \"info\": default gives provides basic information number files regions used function \"debug\": verbose row allocations, many CpGs found region, filename parsing etc. mode used one thread R output messages multiple threads without crashing. \"\": logging","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_log_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set and get logging level — set_log_level","text":"set_log_level(): None; sets log level provided level get_log_level(): current logging level string","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_log_level.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set and get logging level — set_log_level","text":"","code":"set_log_level(\"info\") get_log_level() #> [1] \"info\""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the number of available threads — set_threads","title":"Set the number of available threads — set_threads","text":"Sets \"iscream.threads\" option n_threads. see many threads available see ?get_threads().","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the number of available threads — set_threads","text":"","code":"set_threads(n_threads)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the number of available threads — set_threads","text":"n_threads number threads use","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the number of available threads — set_threads","text":"None. Sets iscream.threads option requested number threads available","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set the number of available threads — set_threads","text":"iscream uses OpenMP parallelize certain functions. can use many threads available system varying degrees performance improvements. get_threads() function uses parallelly::availableCores() report number available threads. Although OpenMP can detect number available cores, high preformance computers (HPCs) resource allocating job schedulers like SLURM, OpenMP may detect available threads across HPC limit cores allocated scheduler. system administrator set limits, may result job taking resources jobs. limits, trying use threads available reduce iscream's performance. Job schedulers typically environment variable (e.g. SLURM_CPUS_ON_NODE SLURM) gives actual number available cores. , hyperthreaded systems, count may double available processors. Using hyperthreading guarantee performance improvement - may better set number threads half reported number. parallelly::availableCores() takes HPC scheduler/CRAN/Bioconductor limits account reporting number available threads may reliably report hyperthreading ('system' 'nproc'). set number threads without call set_threads() every session, put   .Rprofile See help('Rprofile') information startup options. Functions currently using multithreading: tabix(), tabix_gr(), 'tabix_raw() query_chroms() make_mat(), make_mat_se(), make_mat_gr(), make_bsseq_mat() summarize_regions(), summarize_meth_regions()","code":"options(iscream.threads = [n_threads])"},{"path":"https://huishenlab.github.io/iscream/dev/reference/set_threads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set the number of available threads — set_threads","text":"","code":"(ncores <- parallelly::availableCores()) #> system  #>      4  if (FALSE) { # \\dontrun{ set_threads(ncores) } # }"},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"Run summarizing functions CpGs BED files across genomic regions. Parallelized across files using threads \"iscream.threads\" option.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"","code":"summarize_meth_regions(   bedfiles,   regions,   fun = \"all\",   aligner = \"biscuit\",   feature_col = NULL,   mval = TRUE,   set_region_rownames = FALSE,   nthreads = NULL )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"bedfiles vector BED file paths regions vector, data frame GenomicRanges genomic regions. See details. fun Function(s) apply region. See details. aligner aligner used produce BED files - one \"biscuit\", \"bismark\", \"bsbolt\". feature_col Column name input regions data frame containing name genomic region. Set using data frame input regions format. See details. mval Whether calculate M value (coverage \\(\\times \\beta\\)) use beta value applying function. set_region_rownames Use region strings returned data frame's rownames. Can useful named regions want regions strings rownames feature names. See details. nthreads Set number threads use overriding \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"data.frame","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"supported-functions","dir":"Reference","previous_headings":"","what":"Supported functions","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"Sum: \"sum\" Mean: \"mean\" Median: \"median\" Standard deviation: \"stddev\" Variance: \"variance\" Minimum: \"min\" Maximum: \"max\" Range: \"range\" . records region: \"count\" summarizing computations backed Armadillo library. See https://arma.sourceforge.net/docs.html#stats_fns futher details supported functions","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"using-feature-identifiers","dir":"Reference","previous_headings":"","what":"Using feature identifiers","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"regions may string vector form \"chr:start-end\", GRanges object data frame \"chr\", \"start\", \"end\" columns. feature column output contain \"chr:start-end\" identifier summarized region. use identifiers, like gene name region instead coordinates, set names vector GRanges identifiers. names used instead genomic region string describe feature output dataframe. regions data frame make additional column identifiers pass column name feature_col. See examples.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_meth_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize CpGs methylation information over genomic regions — summarize_meth_regions","text":"","code":"# also see examples from ?summarize_regions  bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE)  # make a vector of regions regions <- c(\"chr1:1-6\", \"chr1:7-10\", \"chr1:11-14\") summarize_meth_regions(bedfiles, regions) #> [18:21:05.939776] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:05.939799] [iscream::summarize_regions] [info] using sum, mean, median, stddev, variance, min, max, range, count #> [18:21:05.939804] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, M #>       feature file coverage.sum M.sum coverage.mean    M.mean coverage.median #> 1    chr1:1-6    a            4     2      1.333333 0.6666667             1.0 #> 2   chr1:7-10    a            3     1      1.500000 0.5000000             1.5 #> 3  chr1:11-14    a            5     5      2.500000 2.5000000             2.5 #> 4    chr1:1-6    b            4     2      2.000000 1.0000000             2.0 #> 5   chr1:7-10    b            1     1      1.000000 1.0000000             1.0 #> 6  chr1:11-14    b            3     1      1.500000 0.5000000             1.5 #> 7    chr1:1-6    c            2     2      2.000000 2.0000000             2.0 #> 8   chr1:7-10    c            3     1      1.500000 0.5000000             1.5 #> 9  chr1:11-14    c           NA    NA            NA        NA              NA #> 10   chr1:1-6    d            3     3      1.500000 1.5000000             1.5 #> 11  chr1:7-10    d            3     1      1.500000 0.5000000             1.5 #> 12 chr1:11-14    d            1     1      1.000000 1.0000000             1.0 #>    M.median coverage.stddev  M.stddev coverage.variance M.variance coverage.min #> 1       1.0       0.5773503 0.5773503         0.3333333  0.3333333            1 #> 2       0.5       0.7071068 0.7071068         0.5000000  0.5000000            1 #> 3       2.5       0.7071068 0.7071068         0.5000000  0.5000000            2 #> 4       1.0       0.0000000 1.4142136         0.0000000  2.0000000            2 #> 5       1.0       0.0000000 0.0000000         0.0000000  0.0000000            1 #> 6       0.5       0.7071068 0.7071068         0.5000000  0.5000000            1 #> 7       2.0       0.0000000 0.0000000         0.0000000  0.0000000            2 #> 8       0.5       0.7071068 0.7071068         0.5000000  0.5000000            1 #> 9        NA              NA        NA                NA         NA           NA #> 10      1.5       0.7071068 0.7071068         0.5000000  0.5000000            1 #> 11      0.5       0.7071068 0.7071068         0.5000000  0.5000000            1 #> 12      1.0       0.0000000 0.0000000         0.0000000  0.0000000            1 #>    M.min coverage.max M.max coverage.range M.range cpg_count #> 1      0            2     1              1       1         3 #> 2      0            2     1              1       1         2 #> 3      2            3     3              1       1         2 #> 4      0            2     2              0       2         2 #> 5      1            1     1              0       0         1 #> 6      0            2     1              1       1         2 #> 7      2            2     2              0       0         1 #> 8      0            2     1              1       1         2 #> 9     NA           NA    NA             NA      NA        NA #> 10     1            2     2              1       1         2 #> 11     0            2     1              1       1         2 #> 12     1            1     1              0       0         1 names(regions) <- c(\"A\", \"B\", \"C\") summarize_meth_regions(bedfiles, regions, fun = c(\"mean\", \"stddev\"), mval = FALSE) #> [18:21:05.958418] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:05.958431] [iscream::summarize_regions] [info] using mean, stddev #> [18:21:05.958434] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, beta #>    feature file coverage.mean beta.mean coverage.stddev beta.stddev #> 1        A    a      1.333333 0.6666667       0.5773503   0.5773503 #> 2        B    a      1.500000 0.2500000       0.7071068   0.3535534 #> 3        C    a      2.500000 1.0000000       0.7071068   0.0000000 #> 4        A    b      2.000000 0.5000000       0.0000000   0.7071068 #> 5        B    b      1.000000 1.0000000       0.0000000   0.0000000 #> 6        C    b      1.500000 0.5000000       0.7071068   0.7071068 #> 7        A    c      2.000000 1.0000000       0.0000000   0.0000000 #> 8        B    c      1.500000 0.5000000       0.7071068   0.7071068 #> 9        C    c            NA        NA              NA          NA #> 10       A    d      1.500000 1.0000000       0.7071068   0.0000000 #> 11       B    d      1.500000 0.2500000       0.7071068   0.3535534 #> 12       C    d      1.000000 1.0000000       0.0000000   0.0000000 summarize_meth_regions(bedfiles, regions, fun = \"sum\") #> [18:21:05.962579] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:05.962590] [iscream::summarize_regions] [info] using sum #> [18:21:05.962593] [iscream::summarize_regions] [info] with columns 4, 5 as coverage, M #>    feature file coverage.sum M.sum #> 1        A    a            4     2 #> 2        B    a            3     1 #> 3        C    a            5     5 #> 4        A    b            4     2 #> 5        B    b            1     1 #> 6        C    b            3     1 #> 7        A    c            2     2 #> 8        B    c            3     1 #> 9        C    c           NA    NA #> 10       A    d            3     3 #> 11       B    d            3     1 #> 12       C    d            1     1"},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize information over genomic regions from any BED file — summarize_regions","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"Run summarizing functions BED file records across genomic regions. Parallelized across files using threads \"iscream.threads\" option.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"","code":"summarize_regions(   bedfiles,   regions,   columns,   col_names = NULL,   fun = \"all\",   feature_col = NULL,   set_region_rownames = FALSE,   nthreads = NULL )"},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"bedfiles vector BED file paths regions vector, data frame GenomicRanges genomic regions. See details. columns vector indices numeric columns summarized col_names vector names use columns output fun Function(s) apply region. See details. feature_col Column name input regions data frame containing name genomic region. Set using data frame input regions format. See details. set_region_rownames Use region strings returned data frame's rownames. Can useful named regions want regions strings rownames feature names. See details. nthreads Set number threads use overriding \"iscream.threads\" option. See ?set_threads information.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"data.frame","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"supported-functions","dir":"Reference","previous_headings":"","what":"Supported functions","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"Sum: \"sum\" Mean: \"mean\" Median: \"median\" Standard deviation: \"stddev\" Variance: \"variance\" Minimum: \"min\" Maximum: \"max\" Range: \"range\" . records region: \"count\" summarizing computations backed Armadillo library. See https://arma.sourceforge.net/docs.html#stats_fns futher details supported functions","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"using-feature-identifiers","dir":"Reference","previous_headings":"","what":"Using feature identifiers","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"regions may string vector form \"chr:start-end\", GRanges object data frame \"chr\", \"start\", \"end\" columns. feature column output contain \"chr:start-end\" identifier summarized region. use identifiers, like gene name region instead coordinates, set names vector GRanges identifiers. names used instead genomic region string describe feature output dataframe. regions data frame make additional column identifiers pass column name feature_col. See examples.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/summarize_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize information over genomic regions from any BED file — summarize_regions","text":"","code":"bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE) # examine the bedfiles colnames <- c(\"chr\", \"start\", \"end\", \"beta\", \"coverage\") lapply(bedfiles, function(i) knitr::kable(read.table(i, col.names = colnames))) #> [[1]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        1| #> |chr1 |     4|   6|  0.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    10|  12|  1.0|        2| #> |chr1 |    12|  14|  1.0|        3| #>  #> [[2]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|    0|        2| #> |chr1 |     4|   6|    1|        2| #> |chr1 |     6|   8|    1|        1| #> |chr1 |    10|  12|    0|        2| #> |chr1 |    12|  14|    1|        1| #>  #> [[3]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     2|   4|    1|        2| #> |chr1 |     6|   8|    0|        2| #> |chr1 |     8|  10|    1|        1| #>  #> [[4]] #>  #>  #> |chr  | start| end| beta| coverage| #> |:----|-----:|---:|----:|--------:| #> |chr1 |     0|   2|  1.0|        1| #> |chr1 |     2|   4|  1.0|        2| #> |chr1 |     6|   8|  0.0|        1| #> |chr1 |     8|  10|  0.5|        2| #> |chr1 |    12|  14|  1.0|        1| #>   # make a vector of regions regions <- c(\"chr1:1-6\", \"chr1:7-10\", \"chr1:11-14\") summarize_regions(bedfiles, regions, columns = c(4, 5), col_names = c(\"beta\", \"cov\")) #> [18:21:06.194082] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:06.194097] [iscream::summarize_regions] [info] using sum, mean, median, stddev, variance, min, max, range, count #> [18:21:06.194100] [iscream::summarize_regions] [info] with columns 4, 5 as beta, cov #>       feature file beta.sum cov.sum beta.mean cov.mean beta.median cov.median #> 1    chr1:1-6    a      2.0       4 0.6666667 1.333333        1.00        1.0 #> 2   chr1:7-10    a      0.5       3 0.2500000 1.500000        0.25        1.5 #> 3  chr1:11-14    a      2.0       5 1.0000000 2.500000        1.00        2.5 #> 4    chr1:1-6    b      1.0       4 0.5000000 2.000000        0.50        2.0 #> 5   chr1:7-10    b      1.0       1 1.0000000 1.000000        1.00        1.0 #> 6  chr1:11-14    b      1.0       3 0.5000000 1.500000        0.50        1.5 #> 7    chr1:1-6    c      1.0       2 1.0000000 2.000000        1.00        2.0 #> 8   chr1:7-10    c      1.0       3 0.5000000 1.500000        0.50        1.5 #> 9  chr1:11-14    c       NA      NA        NA       NA          NA         NA #> 10   chr1:1-6    d      2.0       3 1.0000000 1.500000        1.00        1.5 #> 11  chr1:7-10    d      0.5       3 0.2500000 1.500000        0.25        1.5 #> 12 chr1:11-14    d      1.0       1 1.0000000 1.000000        1.00        1.0 #>    beta.stddev cov.stddev beta.variance cov.variance beta.min cov.min beta.max #> 1    0.5773503  0.5773503     0.3333333    0.3333333        0       1      1.0 #> 2    0.3535534  0.7071068     0.1250000    0.5000000        0       1      0.5 #> 3    0.0000000  0.7071068     0.0000000    0.5000000        1       2      1.0 #> 4    0.7071068  0.0000000     0.5000000    0.0000000        0       2      1.0 #> 5    0.0000000  0.0000000     0.0000000    0.0000000        1       1      1.0 #> 6    0.7071068  0.7071068     0.5000000    0.5000000        0       1      1.0 #> 7    0.0000000  0.0000000     0.0000000    0.0000000        1       2      1.0 #> 8    0.7071068  0.7071068     0.5000000    0.5000000        0       1      1.0 #> 9           NA         NA            NA           NA       NA      NA       NA #> 10   0.0000000  0.7071068     0.0000000    0.5000000        1       1      1.0 #> 11   0.3535534  0.7071068     0.1250000    0.5000000        0       1      0.5 #> 12   0.0000000  0.0000000     0.0000000    0.0000000        1       1      1.0 #>    cov.max beta.range cov.range count #> 1        2        1.0         1     3 #> 2        2        0.5         1     2 #> 3        3        0.0         1     2 #> 4        2        1.0         0     2 #> 5        1        0.0         0     1 #> 6        2        1.0         1     2 #> 7        2        0.0         0     1 #> 8        2        1.0         1     2 #> 9       NA         NA        NA    NA #> 10       2        0.0         1     2 #> 11       2        0.5         1     2 #> 12       1        0.0         0     1  # select functions summarize_regions(   bedfiles,   regions,   fun = c(\"mean\", \"stddev\"),   columns = c(4, 5),   col_names = c(\"beta\", \"cov\") ) #> [18:21:06.207806] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:06.207816] [iscream::summarize_regions] [info] using mean, stddev #> [18:21:06.207819] [iscream::summarize_regions] [info] with columns 4, 5 as beta, cov #>       feature file beta.mean cov.mean beta.stddev cov.stddev #> 1    chr1:1-6    a 0.6666667 1.333333   0.5773503  0.5773503 #> 2   chr1:7-10    a 0.2500000 1.500000   0.3535534  0.7071068 #> 3  chr1:11-14    a 1.0000000 2.500000   0.0000000  0.7071068 #> 4    chr1:1-6    b 0.5000000 2.000000   0.7071068  0.0000000 #> 5   chr1:7-10    b 1.0000000 1.000000   0.0000000  0.0000000 #> 6  chr1:11-14    b 0.5000000 1.500000   0.7071068  0.7071068 #> 7    chr1:1-6    c 1.0000000 2.000000   0.0000000  0.0000000 #> 8   chr1:7-10    c 0.5000000 1.500000   0.7071068  0.7071068 #> 9  chr1:11-14    c        NA       NA          NA         NA #> 10   chr1:1-6    d 1.0000000 1.500000   0.0000000  0.7071068 #> 11  chr1:7-10    d 0.2500000 1.500000   0.3535534  0.7071068 #> 12 chr1:11-14    d 1.0000000 1.000000   0.0000000  0.0000000  # add names to the regions names(regions) <- c(\"A\", \"B\", \"C\") summarize_regions(   bedfiles,   regions,   fun = \"sum\",   columns = 5,   col_names = \"coverage\" ) #> [18:21:06.211797] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:06.211809] [iscream::summarize_regions] [info] using sum #> [18:21:06.211812] [iscream::summarize_regions] [info] with columns 5 as coverage #>    feature file coverage.sum #> 1        A    a            4 #> 2        B    a            3 #> 3        C    a            5 #> 4        A    b            4 #> 5        B    b            1 #> 6        C    b            3 #> 7        A    c            2 #> 8        B    c            3 #> 9        C    c           NA #> 10       A    d            3 #> 11       B    d            3 #> 12       C    d            1  # using `feature_col` library(data.table)  # convert string vector to a data.table regions_df <- data.table::as.data.table(regions) |> _[, tstrsplit(regions, \":|-\", fixed = FALSE, names = c(\"chr\", \"start\", \"end\"))] |> _[, start := as.integer(start)] |> _[, feature := LETTERS[.I]][] regions_df #>       chr start    end feature #>    <char> <int> <char>  <char> #> 1:   chr1     1      6       A #> 2:   chr1     7     10       B #> 3:   chr1    11     14       C  summarize_regions(   bedfiles,   regions_df,   fun = \"sum\",   columns = 5,   col_names = \"coverage\",   feature_col = \"feature\" ) #> [18:21:06.226243] [iscream::summarize_regions] [info] Summarizing 3 regions from 4 bedfiles #> [18:21:06.226257] [iscream::summarize_regions] [info] using sum #> [18:21:06.226260] [iscream::summarize_regions] [info] with columns 5 as coverage #>    feature file coverage.sum #> 1        A    a            4 #> 2        B    a            3 #> 3        C    a            5 #> 4        A    b            4 #> 5        B    b            1 #> 6        C    b            3 #> 7        A    c            2 #> 8        B    c            3 #> 9        C    c           NA #> 10       A    d            3 #> 11       B    d            3 #> 12       C    d            1"},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":null,"dir":"Reference","previous_headings":"","what":"Query records from tabixed BED files — tabix","title":"Query records from tabixed BED files — tabix","text":"Query records tabixed BED files","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query records from tabixed BED files — tabix","text":"","code":"tabix(bedfiles, regions, aligner = NULL, col.names = NULL, nthreads = NULL)  tabix_gr(   bedfiles,   regions,   aligner = NULL,   col.names = NULL,   zero_based = TRUE,   nthreads = NULL )  tabix_raw(bedfiles, regions, nthreads = NULL)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query records from tabixed BED files — tabix","text":"bedfiles BED files queried regions vector, data frame GenomicRanges genomic regions. See details. aligner aligner used produce BED files - one \"biscuit\", \"bismark\", \"bsbolt\". set result data.table's column names based argument. col.names vector column names data columns result.table, including \"chr\", \"start\", \"end\". Set BED file supported aligners general BED file. nthreads Set number threads use overriding \"iscream.threads\" option. See ?set_threads information. zero_based Whether input BED file zero-based start column - used coverting result data frame GenomicRanges.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query records from tabixed BED files — tabix","text":"tabix(): data frame tabix_gr(): GRanges object single files GRangesList multiple files. making GRanges, 0-based records BED-files converted 1-based GenomicRanges::makeGRangesFromDataFrame(). Bismark's coverage files converted already 1-based ranges slot one position. tabix_raw(): named list raw strings regions style Rsamtools::scanTabix","code":""},{"path":[]},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"query-method","dir":"Reference","previous_headings":"","what":"Query method","title":"Query records from tabixed BED files — tabix","text":"'iscream two methods query records BED files: tabix shell executable: fast since output can redirected file (data.table::fread() can read) instead allocate memory store query iscream's tabix implementation, based tabix executable using htslib, slower large queries since stores records found instead writing file. However able store region's records independently instead single file used make_mat(), make_bsseq_mat(), summarize_regions(). iscream attached, checks tabix executable available Sys.() , available, sets options(\"tabix.method\" = \"shell\"). tabix() uses tabix executable make queries, except tabix_raw(). tabix found, iscream uses tabix implementation. use iscream's tabix implementation, set options(\"tabix.method\" = \"htslib\").","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"input-region-formats","dir":"Reference","previous_headings":"","what":"Input region formats","title":"Query records from tabixed BED files — tabix","text":"input regions formats may string vector form \"chr:start-end\", dataframe \"chr\", \"start\" \"end\" columns GRanges object. Input regions must 1-based.","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/tabix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query records from tabixed BED files — tabix","text":"","code":"bedfiles <- system.file(\"extdata\", package = \"iscream\") |>   list.files(pattern = \"[a|b|c|d].bed.gz$\", full.names = TRUE) regions <- c(\"chr1:1-6\", \"chr1:7-10\", \"chr1:11-14\") tabix(bedfiles, regions, col.names = c(\"beta\", \"coverage\")) #>        chr start   end  beta coverage   file #>     <char> <int> <int> <num>    <int> <char> #>  1:   chr1     0     2   1.0        1      a #>  2:   chr1     2     4   1.0        1      a #>  3:   chr1     4     6   0.0        2      a #>  4:   chr1     6     8   0.0        1      a #>  5:   chr1     8    10   0.5        2      a #>  6:   chr1    10    12   1.0        2      a #>  7:   chr1    12    14   1.0        3      a #>  8:   chr1     0     2   0.0        2      b #>  9:   chr1     4     6   1.0        2      b #> 10:   chr1     6     8   1.0        1      b #> 11:   chr1    10    12   0.0        2      b #> 12:   chr1    12    14   1.0        1      b #> 13:   chr1     2     4   1.0        2      c #> 14:   chr1     6     8   0.0        2      c #> 15:   chr1     8    10   1.0        1      c #> 16:   chr1     0     2   1.0        1      d #> 17:   chr1     2     4   1.0        2      d #> 18:   chr1     6     8   0.0        1      d #> 19:   chr1     8    10   0.5        2      d #> 20:   chr1    12    14   1.0        1      d #>        chr start   end  beta coverage   file tabix_gr(bedfiles, regions, col.names = c(\"beta\", \"coverage\")) #> GRangesList object of length 4: #> $a #> GRanges object with 7 ranges and 3 metadata columns: #>       seqnames    ranges strand |      beta  coverage        file #>          <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> #>   [1]     chr1       1-2      * |       1.0         1           a #>   [2]     chr1       3-4      * |       1.0         1           a #>   [3]     chr1       5-6      * |       0.0         2           a #>   [4]     chr1       7-8      * |       0.0         1           a #>   [5]     chr1      9-10      * |       0.5         2           a #>   [6]     chr1     11-12      * |       1.0         2           a #>   [7]     chr1     13-14      * |       1.0         3           a #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $b #> GRanges object with 5 ranges and 3 metadata columns: #>       seqnames    ranges strand |      beta  coverage        file #>          <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> #>   [1]     chr1       1-2      * |         0         2           b #>   [2]     chr1       5-6      * |         1         2           b #>   [3]     chr1       7-8      * |         1         1           b #>   [4]     chr1     11-12      * |         0         2           b #>   [5]     chr1     13-14      * |         1         1           b #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $c #> GRanges object with 3 ranges and 3 metadata columns: #>       seqnames    ranges strand |      beta  coverage        file #>          <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> #>   [1]     chr1       3-4      * |         1         2           c #>   [2]     chr1       7-8      * |         0         2           c #>   [3]     chr1      9-10      * |         1         1           c #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $d #> GRanges object with 5 ranges and 3 metadata columns: #>       seqnames    ranges strand |      beta  coverage        file #>          <Rle> <IRanges>  <Rle> | <numeric> <integer> <character> #>   [1]     chr1       1-2      * |       1.0         1           d #>   [2]     chr1       3-4      * |       1.0         2           d #>   [3]     chr1       7-8      * |       0.0         1           d #>   [4]     chr1      9-10      * |       0.5         2           d #>   [5]     chr1     13-14      * |       1.0         1           d #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  tabix_raw(bedfiles, regions) #> $a #> $a$`chr1:1-6` #> [1] \"chr1\\t0\\t2\\t1.000\\t1\" \"chr1\\t2\\t4\\t1.000\\t1\" \"chr1\\t4\\t6\\t0.000\\t2\" #>  #> $a$`chr1:7-10` #> [1] \"chr1\\t6\\t8\\t0.000\\t1\"  \"chr1\\t8\\t10\\t0.500\\t2\" #>  #> $a$`chr1:11-14` #> [1] \"chr1\\t10\\t12\\t1.000\\t2\" \"chr1\\t12\\t14\\t1.000\\t3\" #>  #>  #> $b #> $b$`chr1:1-6` #> [1] \"chr1\\t0\\t2\\t0.000\\t2\" \"chr1\\t4\\t6\\t1.000\\t2\" #>  #> $b$`chr1:7-10` #> [1] \"chr1\\t6\\t8\\t1.000\\t1\" #>  #> $b$`chr1:11-14` #> [1] \"chr1\\t10\\t12\\t0.000\\t2\" \"chr1\\t12\\t14\\t1.000\\t1\" #>  #>  #> $c #> $c$`chr1:1-6` #> [1] \"chr1\\t2\\t4\\t1.000\\t2\" #>  #> $c$`chr1:7-10` #> [1] \"chr1\\t6\\t8\\t0.000\\t2\"  \"chr1\\t8\\t10\\t1.000\\t1\" #>  #> $c$`chr1:11-14` #> character(0) #>  #>  #> $d #> $d$`chr1:1-6` #> [1] \"chr1\\t0\\t2\\t1.000\\t1\" \"chr1\\t2\\t4\\t1.000\\t2\" #>  #> $d$`chr1:7-10` #> [1] \"chr1\\t6\\t8\\t0.000\\t1\"  \"chr1\\t8\\t10\\t0.500\\t2\" #>  #> $d$`chr1:11-14` #> [1] \"chr1\\t12\\t14\\t1.000\\t1\" #>  #>"},{"path":"https://huishenlab.github.io/iscream/dev/reference/validate_log_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate provided logging level — validate_log_level","title":"Validate provided logging level — validate_log_level","text":"\"info\" \"debug\" currently supported, \"debug\" supported using 1 thread","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/validate_log_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate provided logging level — validate_log_level","text":"","code":"validate_log_level(level = get_log_level(), n_threads)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/validate_log_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate provided logging level — validate_log_level","text":"level logging level validate n_threads number threads next iscream function call use","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/validate_log_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate provided logging level — validate_log_level","text":"None; sets log level provide level","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/validate_log_level.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate provided logging level — validate_log_level","text":"","code":"set_log_level(\"info\")"},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_aligner_or_stop.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate provided aligner — verify_aligner_or_stop","title":"Validate provided aligner — verify_aligner_or_stop","text":"\"biscuit\", \"bismark\", \"bsbolt\" currently supported","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_aligner_or_stop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate provided aligner — verify_aligner_or_stop","text":"","code":"verify_aligner_or_stop(aligner)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_aligner_or_stop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate provided aligner — verify_aligner_or_stop","text":"aligner input alinger","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_aligner_or_stop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate provided aligner — verify_aligner_or_stop","text":"true; quits input among supported_aligners","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_files_or_stop.html","id":null,"dir":"Reference","previous_headings":"","what":"Verify that BED files are tabixed — verify_files_or_stop","title":"Verify that BED files are tabixed — verify_files_or_stop","text":"Verify BED files tabixed","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_files_or_stop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Verify that BED files are tabixed — verify_files_or_stop","text":"","code":"verify_files_or_stop(bedfiles, verify_tabix = TRUE)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_files_or_stop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Verify that BED files are tabixed — verify_files_or_stop","text":"bedfiles vector BED file paths verify_tabix Whether verify presence tabix files","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_files_or_stop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Verify that BED files are tabixed — verify_files_or_stop","text":"TRUE input BED files associated tabix index file. FALSE ","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_filetype.html","id":null,"dir":"Reference","previous_headings":"","what":"Verify that the input BED files are of the type specified by the input aligner — verify_filetype","title":"Verify that the input BED files are of the type specified by the input aligner — verify_filetype","text":"Verify input BED files type specified input aligner","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_filetype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Verify that the input BED files are of the type specified by the input aligner — verify_filetype","text":"","code":"verify_filetype(bedfiles, aligner, stop_on_error = FALSE)"},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_filetype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Verify that the input BED files are of the type specified by the input aligner — verify_filetype","text":"bedfiles vector BED file paths aligner aligner chosen stop_on_error Whether warn stop aligner-filename mismatch","code":""},{"path":"https://huishenlab.github.io/iscream/dev/reference/verify_filetype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Verify that the input BED files are of the type specified by the input aligner — verify_filetype","text":"TRUE input BED files associated tabix index file. FALSE ","code":""},{"path":"https://huishenlab.github.io/iscream/dev/news/index.html","id":"iscream-0990","dir":"Changelog","previous_headings":"","what":"iscream 0.99.0","title":"iscream 0.99.0","text":"Pre-release","code":""}]
